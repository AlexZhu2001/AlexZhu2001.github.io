<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/128x128.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/16x16.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"alexzhu2001.github.io","root":"/","scheme":"Mist","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":true,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="Alex&#39;s Blog">
<meta property="og:url" content="https://alexzhu2001.github.io/AlexZhu2001/index.html">
<meta property="og:site_name" content="Alex&#39;s Blog">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="Alex Zhu">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://alexzhu2001.github.io/AlexZhu2001/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>Alex's Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

  <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Alex's Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://alexzhu2001.github.io/AlexZhu2001/2021/07/15/SDN/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/head.png">
      <meta itemprop="name" content="Alex Zhu">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Alex's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/07/15/SDN/" class="post-title-link" itemprop="url">SDN</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-07-15 20:06:26" itemprop="dateCreated datePublished" datetime="2021-07-15T20:06:26+08:00">2021-07-15</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-07-18 21:17:06" itemprop="dateModified" datetime="2021-07-18T21:17:06+08:00">2021-07-18</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="SDN"><a href="#SDN" class="headerlink" title="SDN"></a>SDN</h1><h2 id="1-Mininet-基本使用"><a href="#1-Mininet-基本使用" class="headerlink" title="1. Mininet 基本使用"></a>1. Mininet 基本使用</h2><h3 id="Mininet指令"><a href="#Mininet指令" class="headerlink" title="Mininet指令"></a>Mininet指令</h3><h4 id="net"><a href="#net" class="headerlink" title="net"></a>net</h4><p>查看拓扑链接情况</p>
<h4 id="xterm"><a href="#xterm" class="headerlink" title="xterm"></a>xterm</h4><p><code>xterm [hosts]</code><br>打开对应主机终端</p>
<h4 id="pingall"><a href="#pingall" class="headerlink" title="pingall"></a>pingall</h4><p>测试所有设备联通性</p>
<h4 id="在对应主机执行指令"><a href="#在对应主机执行指令" class="headerlink" title="在对应主机执行指令"></a>在对应主机执行指令</h4><p><code>[host] &#123;command&#125;</code></p>
<h3 id="iperf指令"><a href="#iperf指令" class="headerlink" title="iperf指令"></a>iperf指令</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">iperf </span><br><span class="line">    -c [ip] 客户端IP 与-s互斥</span><br><span class="line">    -s 服务器 与-c互斥</span><br><span class="line">    -t [seconds] 测量时间</span><br><span class="line">    -i [seconds] 测量报告次数</span><br><span class="line">    -p [port] 端口</span><br><span class="line">    -u 使用UDP</span><br></pre></td></tr></table></figure>
<h2 id="2-链路性能参数设置及iperf数据绘图"><a href="#2-链路性能参数设置及iperf数据绘图" class="headerlink" title="2. 链路性能参数设置及iperf数据绘图"></a>2. 链路性能参数设置及iperf数据绘图</h2><h3 id="链路性能设置"><a href="#链路性能设置" class="headerlink" title="链路性能设置"></a>链路性能设置</h3><p><code>mn --link=tc,loss=[loss_rate],bw=[band_width],delay=&#39;[delay]&#39;</code></p>
<p>loss -&gt; 每条链路的丢包率<br>bw -&gt; 链路带宽<br>delay -&gt; 每条链路的延迟</p>
<h3 id="iperf结果绘图"><a href="#iperf结果绘图" class="headerlink" title="iperf结果绘图"></a>iperf结果绘图</h3><p>在服务器端使用 <code>iperf -s -i 1 | tee tcp.txt</code><br>将结果通过管道存放到文件</p>
<p>效果如下<br><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">------------------------------------------------------------</span><br><span class="line">Server listening on TCP port 5001</span><br><span class="line">TCP window size: 85.3 KByte (default)</span><br><span class="line">------------------------------------------------------------</span><br><span class="line">[ 14] local 10.0.0.2 port 5001 connected with 10.0.0.1 port 60150</span><br><span class="line">[ ID] Interval       Transfer     Bandwidth</span><br><span class="line">[ 14]  0.0- 1.0 sec  1.08 MBytes  9.09 Mbits/sec</span><br><span class="line">[ 14]  1.0- 2.0 sec  1.14 MBytes  9.56 Mbits/sec</span><br><span class="line">[ 14]  2.0- 3.0 sec  1.14 MBytes  9.57 Mbits/sec</span><br><span class="line">[ 14]  3.0- 4.0 sec  1.14 MBytes  9.56 Mbits/sec</span><br><span class="line">[ 14]  4.0- 5.0 sec  1.14 MBytes  9.57 Mbits/sec</span><br><span class="line">[ 14]  5.0- 6.0 sec  1.14 MBytes  9.57 Mbits/sec</span><br><span class="line">[ 14]  6.0- 7.0 sec  1.14 MBytes  9.56 Mbits/sec</span><br><span class="line">[ 14]  7.0- 8.0 sec  1.14 MBytes  9.57 Mbits/sec</span><br><span class="line">[ 14]  8.0- 9.0 sec  1.14 MBytes  9.55 Mbits/sec</span><br><span class="line">[ 14]  9.0-10.0 sec  1.14 MBytes  9.58 Mbits/sec</span><br><span class="line">[ 14] 10.0-11.0 sec  1.14 MBytes  9.57 Mbits/sec</span><br><span class="line">[ 14] 11.0-12.0 sec  1.14 MBytes  9.55 Mbits/sec</span><br><span class="line">[ 14] 12.0-13.0 sec  1.14 MBytes  9.58 Mbits/sec</span><br><span class="line">[ 14]  0.0-13.1 sec  14.9 MBytes  9.53 Mbits/sec</span><br></pre></td></tr></table></figure></p>
<p>然后 使用</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat tcp.txt | grep sec | head -n 10 | tr <span class="string">&quot;-&quot;</span> <span class="string">&quot; &quot;</span> | awk <span class="string">&#x27;&#123;print $4,$8&#125; &gt; a&#x27;</span></span><br></pre></td></tr></table></figure>
<p>其中 </p>
<ul>
<li><code>cat tcp.txt</code>读取文件并显示 </li>
<li><code>grep sec</code> 会标记出含有sec的列</li>
<li><code>head -n 10</code> 取出前十行</li>
<li><code>tr &quot;-&quot; &quot; &quot;</code> 会将<code>-</code>替换为空格</li>
<li><code>awk &#39;&#123;print $4,$8&#125;&#39;</code> 会取出第四列和第八列</li>
</ul>
<p>效果如下<br><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">1.0 9.09</span><br><span class="line">2.0 9.56</span><br><span class="line">3.0 9.57</span><br><span class="line">4.0 9.56</span><br><span class="line">5.0 9.57</span><br><span class="line">6.0 9.57</span><br><span class="line">7.0 9.56</span><br><span class="line">8.0 9.57</span><br><span class="line">9.0 9.55</span><br><span class="line">10.0 9.58</span><br></pre></td></tr></table></figure><br>然后我们使用<code>gnuplot</code>绘图</p>
<ul>
<li>输入<code>gnuplot</code> 回车 进入gnuplot</li>
<li>输入<code>plot &quot;a&quot; title &quot;tcp&quot; with linespoints</code> 绘图,<code>&quot;a&quot;</code> 为文件名,<code>title &quot;tcp&quot;</code>设置标题,<code>with linespoints</code>设置为带点直线</li>
<li><code>set xrange[0:10]</code>和<code>set yrange[0:10]</code>设置x、y轴范围 0 ~ 10</li>
<li><code>set xtics 0,1,10</code>和<code>set ytics 0,1,10</code>设置x、y轴刻度 0开始 10结束 1步进</li>
<li><code>set xlabel &quot;time(sec)&quot;</code>和<code>set ylabel &quot;Throughput(Mbps)&quot;</code>设置x、y轴标记文字</li>
<li><code>set title &quot;Tcp&quot;</code> 设置图标标题为Tcp</li>
<li><code>set terminal gif</code> 设置保存格式为gif</li>
<li><code>set output &quot;a.gif&quot;</code> 设置保存的文件名为<code>a.gif</code></li>
<li><code>replot</code> 修改设置后重绘或者可以保存文件</li>
</ul>
<img src="/2021/07/15/SDN/2-1.gif" class="" title="绘图效果">
<h2 id="3-使用Mininet脚本创建简单网络拓扑"><a href="#3-使用Mininet脚本创建简单网络拓扑" class="headerlink" title="3.  使用Mininet脚本创建简单网络拓扑"></a>3.  使用Mininet脚本创建简单网络拓扑</h2><h3 id="1-最简单的路由结构"><a href="#1-最简单的路由结构" class="headerlink" title="1. 最简单的路由结构"></a>1. 最简单的路由结构</h3><p>h1 —— h2</p>
<figure class="highlight python"><figcaption><span>1.py</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="keyword">from</span> mininet.cli <span class="keyword">import</span> CLI</span><br><span class="line"><span class="keyword">from</span> mininet.net <span class="keyword">import</span> Mininet</span><br><span class="line"><span class="keyword">from</span> mininet.link <span class="keyword">import</span> Link,TCLink</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="string">&#x27;__main__&#x27;</span> == __name__:</span><br><span class="line">	net = Mininet(link=TCLink) <span class="comment"># 创建一个Mininet对象 连接方式为TCLink</span></span><br><span class="line">    <span class="comment"># 添加两个host</span></span><br><span class="line">	h1 = net.addHost(<span class="string">&#x27;h1&#x27;</span>)  </span><br><span class="line">	h2 = net.addHost(<span class="string">&#x27;h2&#x27;</span>)</span><br><span class="line">    <span class="comment"># 链接两个host</span></span><br><span class="line">	Link(h1,h2)</span><br><span class="line">    <span class="comment"># 对网络执行构建操作</span></span><br><span class="line">	net.build()</span><br><span class="line">    <span class="comment"># 启动CLI(CommandLine Interface)</span></span><br><span class="line">	CLI(net)</span><br><span class="line">    <span class="comment"># 释放网络结构</span></span><br><span class="line">	net.stop()</span><br></pre></td></tr></table></figure>
<h3 id="2-含一个路由的结构"><a href="#2-含一个路由的结构" class="headerlink" title="2. 含一个路由的结构"></a>2. 含一个路由的结构</h3><p>h1 —— r —— h2<br><figure class="highlight python"><figcaption><span>2.py</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="keyword">from</span> mininet.cli <span class="keyword">import</span> CLI</span><br><span class="line"><span class="keyword">from</span> mininet.net <span class="keyword">import</span> Mininet</span><br><span class="line"><span class="keyword">from</span> mininet.link <span class="keyword">import</span> Link,TCLink</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="string">&#x27;__main__&#x27;</span> == __name__:</span><br><span class="line">	net = Mininet(link=TCLink)</span><br><span class="line">	h1 = net.addHost(<span class="string">&#x27;h1&#x27;</span>)</span><br><span class="line">	h2 = net.addHost(<span class="string">&#x27;h2&#x27;</span>)</span><br><span class="line">    <span class="comment"># 这是作为路由器的设备</span></span><br><span class="line">	r = net.addHost(<span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">    <span class="comment"># 建立到路由的链接</span></span><br><span class="line">	Link(h1,r)</span><br><span class="line">	Link(h2,r)</span><br><span class="line">	net.build()</span><br><span class="line">	CLI(net)</span><br><span class="line">	net.stop()</span><br></pre></td></tr></table></figure></p>
<p>此时网络拓扑结构如下<br><img src="/2021/07/15/SDN/3-1.png" class="" title="拓扑"><br>此时h1和h2是不连通的 需要配置路由使其联通<br>规划如下：</p>
<ul>
<li>h1 使用 192.168.1.1/24 </li>
<li>h2 使用 192.168.2.1/24 </li>
<li>h1 使用 192.168.1.254 与 r 连接</li>
<li>h2 使用 192.168.2.254 与 r 连接<br>步骤如下：</li>
<li>h1 使用 ifconfig h1-eth0 0 清空分配的地址</li>
<li>h1 使用 ifconfig h1-eth0 192.168.1.1/24 分配地址</li>
<li>h2 使用 ifconfig h2-eth0 0 清空分配的地址</li>
<li>h2 使用 ifconfig h2-eth0 192.168.2.1/24 分配地址</li>
<li>h1 使用 ip route add default via 192.168.1.254 设定默认路由</li>
<li>h2 使用 ip route add default via 192.168.2.254 设定默认路由</li>
<li>r 使用 ifconfig r-eth0 0 清空分配的地址</li>
<li>r 使用 ifconfig r-eth0 192.168.1.254/24 分配地址</li>
<li>r 使用 ifconfig r-eth1 0 清空分配的地址</li>
<li>r 使用 ifconfig r-eth1 192.168.2.254/24 分配地址<br>此时两台host已经互通<img src="/2021/07/15/SDN/3-2.png" class="" title="互通">
</li>
</ul>
<h3 id="3-使用脚本自动建立路由"><a href="#3-使用脚本自动建立路由" class="headerlink" title="3. 使用脚本自动建立路由"></a>3. 使用脚本自动建立路由</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="keyword">from</span> mininet.cli <span class="keyword">import</span> CLI</span><br><span class="line"><span class="keyword">from</span> mininet.net <span class="keyword">import</span> Mininet</span><br><span class="line"><span class="keyword">from</span> mininet.link <span class="keyword">import</span> Link,TCLink</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="string">&#x27;__main__&#x27;</span> == __name__:</span><br><span class="line">	net = Mininet(link=TCLink)</span><br><span class="line">	h1 = net.addHost(<span class="string">&#x27;h1&#x27;</span>)</span><br><span class="line">	h2 = net.addHost(<span class="string">&#x27;h2&#x27;</span>)</span><br><span class="line"></span><br><span class="line">	r = net.addHost(<span class="string">&#x27;r&#x27;</span>)</span><br><span class="line"></span><br><span class="line">	Link(h1,r)</span><br><span class="line">	Link(h2,r)</span><br><span class="line">	net.build()</span><br><span class="line"></span><br><span class="line">	<span class="comment"># build route</span></span><br><span class="line">	h1.cmd(<span class="string">&quot;ifconfig h1-eth0 0&quot;</span>)</span><br><span class="line">	h1.cmd(<span class="string">&quot;ifconfig h1-eth0 192.168.1.1/24&quot;</span>)</span><br><span class="line">	h1.cmd(<span class="string">&quot;ip route add default via 192.168.1.254&quot;</span>)</span><br><span class="line">	h2.cmd(<span class="string">&quot;ifconfig h2-eth0 0&quot;</span>)</span><br><span class="line">	h2.cmd(<span class="string">&quot;ifconfig h2-eth0 192.168.2.1/24&quot;</span>)</span><br><span class="line">	h2.cmd(<span class="string">&quot;ip route add default via 192.168.2.254&quot;</span>)</span><br><span class="line">	r.cmd(<span class="string">&quot;ifconfig r-eth0 0&quot;</span>)</span><br><span class="line">	r.cmd(<span class="string">&quot;ifconfig r-eth0 192.168.1.254/24&quot;</span>)</span><br><span class="line">	r.cmd(<span class="string">&quot;ifconfig r-eth1 0&quot;</span>)</span><br><span class="line">	r.cmd(<span class="string">&quot;ifconfig r-eth1 192.168.2.254/24&quot;</span>)</span><br><span class="line">	r.cmd(<span class="string">&quot;echo 1 &gt; /proc/sys/net/ipv4/ip_forward&quot;</span>)</span><br><span class="line"></span><br><span class="line">	CLI(net)</span><br><span class="line">	net.stop()</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="4-使用Mininet脚本创建复杂网络拓扑"><a href="#4-使用Mininet脚本创建复杂网络拓扑" class="headerlink" title="4.  使用Mininet脚本创建复杂网络拓扑"></a>4.  使用Mininet脚本创建复杂网络拓扑</h2><h3 id="1-两个路由器"><a href="#1-两个路由器" class="headerlink" title="1. 两个路由器"></a>1. 两个路由器</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="keyword">from</span> mininet.cli <span class="keyword">import</span> CLI</span><br><span class="line"><span class="keyword">from</span> mininet.net <span class="keyword">import</span> Mininet</span><br><span class="line"><span class="keyword">from</span> mininet.link <span class="keyword">import</span> Link, TCLink</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="string">&#x27;__main__&#x27;</span> == __name__:</span><br><span class="line">    net = Mininet(link=TCLink)</span><br><span class="line">    h1 = net.addHost(<span class="string">&#x27;h1&#x27;</span>)</span><br><span class="line">    h2 = net.addHost(<span class="string">&#x27;h2&#x27;</span>)</span><br><span class="line">    r1 = net.addHost(<span class="string">&#x27;r1&#x27;</span>)</span><br><span class="line">    r2 = net.addHost(<span class="string">&#x27;r2&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    Link(h1,r1)</span><br><span class="line">    Link(h2,r2)</span><br><span class="line">    Link(r1,r2)</span><br><span class="line">    net.build()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># build route</span></span><br><span class="line">    h1.cmd(<span class="string">&quot;ifconfig h1-eth0 0&quot;</span>)</span><br><span class="line">    h1.cmd(<span class="string">&quot;ifconfig h1-eth0 192.168.1.1/24&quot;</span>)</span><br><span class="line">    h1.cmd(<span class="string">&quot;ip route add default via 192.168.1.254&quot;</span>)</span><br><span class="line">    h2.cmd(<span class="string">&quot;ifconfig h2-eth0 0&quot;</span>)</span><br><span class="line">    h2.cmd(<span class="string">&quot;ifconfig h2-eth0 192.168.2.1/24&quot;</span>)</span><br><span class="line">    h2.cmd(<span class="string">&quot;ip route add default via 192.168.2.254&quot;</span>)</span><br><span class="line">    r1.cmd(<span class="string">&quot;ifconfig r1-eth0 0&quot;</span>)</span><br><span class="line">    r1.cmd(<span class="string">&quot;ifconfig r1-eth0 192.168.1.254/24&quot;</span>)</span><br><span class="line">    r1.cmd(<span class="string">&quot;ifconfig r1-eth1 0&quot;</span>)</span><br><span class="line">    r1.cmd(<span class="string">&quot;ifconfig r1-eth1 10.0.0.1/24&quot;</span>)</span><br><span class="line">    r1.cmd(<span class="string">&quot;echo 1 &gt; /proc/sys/net/ipv4/ip_forward&quot;</span>)</span><br><span class="line">    r1.cmd(<span class="string">&quot;ip route add 192.168.2.0/24 via 10.0.0.2&quot;</span>)</span><br><span class="line">    r2.cmd(<span class="string">&quot;ifconfig r2-eth0 0&quot;</span>)</span><br><span class="line">    r2.cmd(<span class="string">&quot;ifconfig r2-eth0 192.168.2.254/24&quot;</span>)</span><br><span class="line">    r2.cmd(<span class="string">&quot;ifconfig r2-eth1 0&quot;</span>)</span><br><span class="line">    r2.cmd(<span class="string">&quot;ifconfig r2-eth1 10.0.0.2/24&quot;</span>)</span><br><span class="line">    r2.cmd(<span class="string">&quot;echo 1 &gt; /proc/sys/net/ipv4/ip_forward&quot;</span>)</span><br><span class="line">    r2.cmd(<span class="string">&quot;ip route add 192.168.1.0/24 via 10.0.0.1&quot;</span>)</span><br><span class="line">    CLI(net)</span><br><span class="line">    net.stop()</span><br></pre></td></tr></table></figure>
<p>拓扑结构如下：<br>h1 h1-eth0:r1-eth0<br>h2 h2-eth0:r2-eth0<br>r1 r1-eth0:h1-eth0 r1-eth1:r2-eth1<br>r2 r2-eth0:h2-eth0 r2-eth1:r1-eth1</p>
<h3 id="2-NAT地址转换"><a href="#2-NAT地址转换" class="headerlink" title="2.NAT地址转换"></a>2.NAT地址转换</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="keyword">from</span> mininet.cli <span class="keyword">import</span> CLI</span><br><span class="line"><span class="keyword">from</span> mininet.net <span class="keyword">import</span> Mininet</span><br><span class="line"><span class="keyword">from</span> mininet.link <span class="keyword">import</span> Link, TCLink</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="string">&#x27;__main__&#x27;</span> == __name__:</span><br><span class="line">    net = Mininet(link=TCLink)</span><br><span class="line">    h1 = net.addHost(<span class="string">&#x27;h1&#x27;</span>)</span><br><span class="line">    h2 = net.addHost(<span class="string">&#x27;h2&#x27;</span>)</span><br><span class="line">    r1 = net.addHost(<span class="string">&#x27;r1&#x27;</span>)</span><br><span class="line">    r2 = net.addHost(<span class="string">&#x27;r2&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    Link(h1,r1)</span><br><span class="line">    Link(h2,r2)</span><br><span class="line">    Link(r1,r2)</span><br><span class="line">    net.build()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># build route</span></span><br><span class="line">    h1.cmd(<span class="string">&quot;ifconfig h1-eth0 0&quot;</span>)</span><br><span class="line">    h1.cmd(<span class="string">&quot;ifconfig h1-eth0 192.168.1.1/24&quot;</span>)</span><br><span class="line">    h1.cmd(<span class="string">&quot;ip route add default via 192.168.1.254&quot;</span>)</span><br><span class="line">    h2.cmd(<span class="string">&quot;ifconfig h2-eth0 0&quot;</span>)</span><br><span class="line">    h2.cmd(<span class="string">&quot;ifconfig h2-eth0 22.1.1.1/24&quot;</span>)</span><br><span class="line">    h2.cmd(<span class="string">&quot;ip route add default via 22.1.1.254&quot;</span>)</span><br><span class="line">    r1.cmd(<span class="string">&quot;ifconfig r1-eth0 0&quot;</span>)</span><br><span class="line">    r1.cmd(<span class="string">&quot;ifconfig r1-eth1 0&quot;</span>)</span><br><span class="line">    r1.cmd(<span class="string">&quot;ifconfig r1-eth0 192.168.1.254/24&quot;</span>)</span><br><span class="line">    r1.cmd(<span class="string">&quot;ifconfig r1-eth1 12.1.1.1/24&quot;</span>)</span><br><span class="line">    r1.cmd(<span class="string">&quot;ip route add default via 12.1.1.2&quot;</span>)</span><br><span class="line">    r1.cmd(<span class="string">&quot;echo 1 &gt; /proc/sys/net/ipv4/ip_forward&quot;</span>)</span><br><span class="line">    r1.cmd(<span class="string">&quot;iptables -t nat -A POSTROUTING -o r1-eth1 -s 192.168.1.0/24 -j MASQUERADE&quot;</span>)</span><br><span class="line">    r2.cmd(<span class="string">&quot;ifconfig r2-eth0 0&quot;</span>)</span><br><span class="line">    r2.cmd(<span class="string">&quot;ifconfig r2-eth0 22.1.1.254/24&quot;</span>)</span><br><span class="line">    r2.cmd(<span class="string">&quot;ifconfig r2-eth1 0&quot;</span>)</span><br><span class="line">    r2.cmd(<span class="string">&quot;ifconfig r2-eth1 12.1.1.2/24&quot;</span>)</span><br><span class="line">    r2.cmd(<span class="string">&quot;echo 1 &gt; /proc/sys/net/ipv4/ip_forward&quot;</span>)</span><br><span class="line">    CLI(net)</span><br><span class="line">    net.stop()</span><br></pre></td></tr></table></figure>
<p>其中 <code>iptables -t nat -A POSTROUTING -o r1-eth1 -s 192.168.1.0/24 -j MASQUERADE</code> 起到了启动NAT的作用<br><code>-t</code>指定了表名为<code>NAT</code><br><code>-A</code>指定了在<code>POSTROUTING</code>末尾插入规则<br><code>-o</code>匹配流出网卡为<code>r1-eth1</code><br><code>-s</code>匹配源地址为<code>192.168.1.0/24</code>网段<br><code>-j</code>使用<code>MASQUERADE</code>选项进行地址伪装 可以自动匹配当前流出网卡的ip地址无需手动指定</p>
<h2 id="5-Mininet中如何创建bridge"><a href="#5-Mininet中如何创建bridge" class="headerlink" title="5. Mininet中如何创建bridge"></a>5. Mininet中如何创建bridge</h2><h3 id="1-简单的桥接"><a href="#1-简单的桥接" class="headerlink" title="1.简单的桥接"></a>1.简单的桥接</h3><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">br1: mybr</span><br><span class="line">      |</span><br><span class="line">      |</span><br><span class="line">   +--+--+</span><br><span class="line">   |     |</span><br><span class="line">   h1    h2</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="keyword">from</span> mininet.cli <span class="keyword">import</span> CLI</span><br><span class="line"><span class="keyword">from</span> mininet.net <span class="keyword">import</span> Mininet</span><br><span class="line"><span class="keyword">from</span> mininet.link <span class="keyword">import</span> Link,TCLink</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="string">&#x27;__main__&#x27;</span> == __name__:</span><br><span class="line">    net = Mininet(link=TCLink) <span class="comment"># Get a mininet object with TCLink</span></span><br><span class="line">    <span class="comment"># add hosts to net object</span></span><br><span class="line">    h1 = net.addHost(<span class="string">&#x27;h1&#x27;</span>)  </span><br><span class="line">    h2 = net.addHost(<span class="string">&#x27;h2&#x27;</span>)</span><br><span class="line">    h3 = net.addHost(<span class="string">&#x27;h3&#x27;</span>)</span><br><span class="line">    br1 = net.addHost(<span class="string">&#x27;br1&#x27;</span>)</span><br><span class="line">    <span class="comment"># create link between to hosts</span></span><br><span class="line">    net.addLink(h1,br1)</span><br><span class="line">    net.addLink(h2,br1)</span><br><span class="line">    net.addLink(h3,br1)</span><br><span class="line">    <span class="comment"># build net structure</span></span><br><span class="line">    net.build()</span><br><span class="line">    <span class="comment"># clear ip addr</span></span><br><span class="line">    h1.cmd(<span class="string">&quot;ifconfig h1-eth0 0&quot;</span>)</span><br><span class="line">    h2.cmd(<span class="string">&quot;ifconfig h2-eth0 0&quot;</span>)</span><br><span class="line">    h3.cmd(<span class="string">&quot;ifconfig h3-eth0 0&quot;</span>)</span><br><span class="line">    br1.cmd(<span class="string">&quot;ifconfig br1-eth0 0&quot;</span>)</span><br><span class="line">    br1.cmd(<span class="string">&quot;ifconfig br1-eth1 0&quot;</span>)</span><br><span class="line">    br1.cmd(<span class="string">&quot;ifconfig br1-eth2 0&quot;</span>)</span><br><span class="line">    <span class="comment"># add bridge</span></span><br><span class="line">    br1.cmd(<span class="string">&quot;brctl addbr mybr&quot;</span>)</span><br><span class="line">    <span class="comment"># add interface to bridge</span></span><br><span class="line">    br1.cmd(<span class="string">&quot;brctl addif mybr br1-eth0&quot;</span>)</span><br><span class="line">    br1.cmd(<span class="string">&quot;brctl addif mybr br1-eth1&quot;</span>)</span><br><span class="line">    br1.cmd(<span class="string">&quot;brctl addif mybr br1-eth2&quot;</span>)</span><br><span class="line">    <span class="comment"># set bridge up</span></span><br><span class="line">    br1.cmd(<span class="string">&quot;ifconfig mybr up&quot;</span>)</span><br><span class="line">    <span class="comment"># set ip address</span></span><br><span class="line">    h1.cmd(<span class="string">&quot;ifconfig h1-eth0 192.168.10.1/24&quot;</span>)</span><br><span class="line">    h2.cmd(<span class="string">&quot;ifconfig h2-eth0 192.168.10.2/24&quot;</span>)</span><br><span class="line">    h3.cmd(<span class="string">&quot;ifconfig h3-eth0 192.168.10.3/24&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># start CommandLine Interface</span></span><br><span class="line">    CLI(net)</span><br><span class="line">    <span class="comment"># release net structure</span></span><br><span class="line">    net.stop()</span><br></pre></td></tr></table></figure>
<h3 id="2-两个网桥"><a href="#2-两个网桥" class="headerlink" title="2.两个网桥"></a>2.两个网桥</h3><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">br1: </span><br><span class="line">  +-----------------------+</span><br><span class="line">  |  mybr1         mybr2  |</span><br><span class="line">  +---|--------------|----+</span><br><span class="line">      |              |</span><br><span class="line">   +--+--+        +--+--+</span><br><span class="line">   |     |        |     |</span><br><span class="line">   h1    h2       h3    h4</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="keyword">from</span> mininet.cli <span class="keyword">import</span> CLI</span><br><span class="line"><span class="keyword">from</span> mininet.net <span class="keyword">import</span> Mininet</span><br><span class="line"><span class="keyword">from</span> mininet.link <span class="keyword">import</span> Link,TCLink</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="string">&#x27;__main__&#x27;</span> == __name__:</span><br><span class="line">    net = Mininet(link=TCLink) <span class="comment"># Get a mininet object with TCLink</span></span><br><span class="line">    <span class="comment"># add hosts to net object</span></span><br><span class="line">    h1 = net.addHost(<span class="string">&#x27;h1&#x27;</span>)  </span><br><span class="line">    h2 = net.addHost(<span class="string">&#x27;h2&#x27;</span>)</span><br><span class="line">    h3 = net.addHost(<span class="string">&#x27;h3&#x27;</span>)</span><br><span class="line">    h4 = net.addHost(<span class="string">&#x27;h4&#x27;</span>)</span><br><span class="line">    br1 = net.addHost(<span class="string">&#x27;br1&#x27;</span>)</span><br><span class="line">    <span class="comment"># create link between to hosts</span></span><br><span class="line">    net.addLink(h1,br1)</span><br><span class="line">    net.addLink(h2,br1)</span><br><span class="line">    net.addLink(h3,br1)</span><br><span class="line">    net.addLink(h4,br1)</span><br><span class="line">    <span class="comment"># build net structure</span></span><br><span class="line">    net.build()</span><br><span class="line">    <span class="comment"># clear ip addr</span></span><br><span class="line">    h1.cmd(<span class="string">&quot;ifconfig h1-eth0 0&quot;</span>)</span><br><span class="line">    h2.cmd(<span class="string">&quot;ifconfig h2-eth0 0&quot;</span>)</span><br><span class="line">    h3.cmd(<span class="string">&quot;ifconfig h3-eth0 0&quot;</span>)</span><br><span class="line">    h4.cmd(<span class="string">&quot;ifconfig h4-eth0 0&quot;</span>)</span><br><span class="line">    br1.cmd(<span class="string">&quot;ifconfig br1-eth0 0&quot;</span>)</span><br><span class="line">    br1.cmd(<span class="string">&quot;ifconfig br1-eth1 0&quot;</span>)</span><br><span class="line">    br1.cmd(<span class="string">&quot;ifconfig br1-eth2 0&quot;</span>)</span><br><span class="line">    br1.cmd(<span class="string">&quot;ifconfig br1-eth3 0&quot;</span>)</span><br><span class="line">    <span class="comment"># add bridge</span></span><br><span class="line">    br1.cmd(<span class="string">&quot;brctl addbr mybr1&quot;</span>)</span><br><span class="line">    br1.cmd(<span class="string">&quot;brctl addbr mybr2&quot;</span>)</span><br><span class="line">    <span class="comment"># add interface to bridge</span></span><br><span class="line">    br1.cmd(<span class="string">&quot;brctl addif mybr1 br1-eth0&quot;</span>)</span><br><span class="line">    br1.cmd(<span class="string">&quot;brctl addif mybr1 br1-eth1&quot;</span>)</span><br><span class="line">    br1.cmd(<span class="string">&quot;brctl addif mybr2 br1-eth2&quot;</span>)</span><br><span class="line">    br1.cmd(<span class="string">&quot;brctl addif mybr2 br1-eth3&quot;</span>)</span><br><span class="line">    <span class="comment"># set bridge up</span></span><br><span class="line">    br1.cmd(<span class="string">&quot;ifconfig mybr1 up&quot;</span>)</span><br><span class="line">    br1.cmd(<span class="string">&quot;ifconfig mybr2 up&quot;</span>)</span><br><span class="line">    <span class="comment"># set ip address</span></span><br><span class="line">    h1.cmd(<span class="string">&quot;ifconfig h1-eth0 192.168.10.1/24&quot;</span>)</span><br><span class="line">    h2.cmd(<span class="string">&quot;ifconfig h2-eth0 192.168.10.2/24&quot;</span>)</span><br><span class="line">    h3.cmd(<span class="string">&quot;ifconfig h3-eth0 192.168.20.1/24&quot;</span>)</span><br><span class="line">    h4.cmd(<span class="string">&quot;ifconfig h4-eth0 192.168.20.2/24&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment"># start CommandLine Interface</span></span><br><span class="line">    CLI(net)</span><br><span class="line">    <span class="comment"># release net structure</span></span><br><span class="line">    net.stop()</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="3-两网桥间互通"><a href="#3-两网桥间互通" class="headerlink" title="3. 两网桥间互通"></a>3. 两网桥间互通</h3><p>通过添加路由器r1 让流量穿过r1 使两网桥互通<br><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">              r1</span><br><span class="line">              |</span><br><span class="line">              |            </span><br><span class="line">      +-------+------+</span><br><span class="line">br1:  |              |</span><br><span class="line">  +---|--------------|----+</span><br><span class="line">  |  mybr1         mybr2  |</span><br><span class="line">  +---|--------------|----+</span><br><span class="line">      |              |</span><br><span class="line">   +--+--+        +--+--+</span><br><span class="line">   |     |        |     |</span><br><span class="line">   h1    h2       h3    h4</span><br></pre></td></tr></table></figure></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="keyword">from</span> mininet.cli <span class="keyword">import</span> CLI</span><br><span class="line"><span class="keyword">from</span> mininet.net <span class="keyword">import</span> Mininet</span><br><span class="line"><span class="keyword">from</span> mininet.link <span class="keyword">import</span> Link,TCLink</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="string">&#x27;__main__&#x27;</span> == __name__:</span><br><span class="line">    net = Mininet(link=TCLink) <span class="comment"># Get a mininet object with TCLink</span></span><br><span class="line">    <span class="comment"># add hosts to net object</span></span><br><span class="line">    h1 = net.addHost(<span class="string">&#x27;h1&#x27;</span>)  </span><br><span class="line">    h2 = net.addHost(<span class="string">&#x27;h2&#x27;</span>)</span><br><span class="line">    h3 = net.addHost(<span class="string">&#x27;h3&#x27;</span>)</span><br><span class="line">    h4 = net.addHost(<span class="string">&#x27;h4&#x27;</span>)</span><br><span class="line">    br1 = net.addHost(<span class="string">&#x27;br1&#x27;</span>)</span><br><span class="line">    r1 = net.addHost(<span class="string">&#x27;r1&#x27;</span>)</span><br><span class="line">    <span class="comment"># create link between to hosts</span></span><br><span class="line">    net.addLink(h1,br1)</span><br><span class="line">    net.addLink(h2,br1)</span><br><span class="line">    net.addLink(h3,br1)</span><br><span class="line">    net.addLink(h4,br1)</span><br><span class="line">    net.addLink(br1,r1)</span><br><span class="line">    net.addLink(br1,r1)</span><br><span class="line">    <span class="comment"># build net structure</span></span><br><span class="line">    net.build()</span><br><span class="line">    <span class="comment"># clear ip addr</span></span><br><span class="line">    h1.cmd(<span class="string">&quot;ifconfig h1-eth0 0&quot;</span>)</span><br><span class="line">    h2.cmd(<span class="string">&quot;ifconfig h2-eth0 0&quot;</span>)</span><br><span class="line">    h3.cmd(<span class="string">&quot;ifconfig h3-eth0 0&quot;</span>)</span><br><span class="line">    h4.cmd(<span class="string">&quot;ifconfig h4-eth0 0&quot;</span>)</span><br><span class="line">    br1.cmd(<span class="string">&quot;ifconfig br1-eth0 0&quot;</span>)</span><br><span class="line">    br1.cmd(<span class="string">&quot;ifconfig br1-eth1 0&quot;</span>)</span><br><span class="line">    br1.cmd(<span class="string">&quot;ifconfig br1-eth2 0&quot;</span>)</span><br><span class="line">    br1.cmd(<span class="string">&quot;ifconfig br1-eth3 0&quot;</span>)</span><br><span class="line">    br1.cmd(<span class="string">&quot;ifconfig br1-eth4 0&quot;</span>)</span><br><span class="line">    br1.cmd(<span class="string">&quot;ifconfig br1-eth5 0&quot;</span>)</span><br><span class="line">    <span class="comment"># add bridge</span></span><br><span class="line">    br1.cmd(<span class="string">&quot;brctl addbr mybr1&quot;</span>)</span><br><span class="line">    br1.cmd(<span class="string">&quot;brctl addbr mybr2&quot;</span>)</span><br><span class="line">    <span class="comment"># add interface to bridge</span></span><br><span class="line">    br1.cmd(<span class="string">&quot;brctl addif mybr1 br1-eth0&quot;</span>)</span><br><span class="line">    br1.cmd(<span class="string">&quot;brctl addif mybr1 br1-eth1&quot;</span>)</span><br><span class="line">    br1.cmd(<span class="string">&quot;brctl addif mybr1 br1-eth4&quot;</span>)</span><br><span class="line">    br1.cmd(<span class="string">&quot;brctl addif mybr2 br1-eth2&quot;</span>)</span><br><span class="line">    br1.cmd(<span class="string">&quot;brctl addif mybr2 br1-eth3&quot;</span>)</span><br><span class="line">    br1.cmd(<span class="string">&quot;brctl addif mybr2 br1-eth5&quot;</span>)</span><br><span class="line">    <span class="comment"># set bridge up</span></span><br><span class="line">    br1.cmd(<span class="string">&quot;ifconfig mybr1 up&quot;</span>)</span><br><span class="line">    br1.cmd(<span class="string">&quot;ifconfig mybr2 up&quot;</span>)</span><br><span class="line">    <span class="comment"># set ip address and route</span></span><br><span class="line">    r1.cmd(<span class="string">&quot;ifconfig r1-eth0 192.168.10.254/24&quot;</span>)</span><br><span class="line">    r1.cmd(<span class="string">&quot;ifconfig r1-eth1 192.168.20.254/24&quot;</span>)</span><br><span class="line">    r1.cmd(<span class="string">&quot;echo 1 &gt; /proc/sys/net/ipv4/ip_forward&quot;</span>)</span><br><span class="line">    h1.cmd(<span class="string">&quot;ifconfig h1-eth0 192.168.10.1/24&quot;</span>)</span><br><span class="line">    h1.cmd(<span class="string">&quot;ip route add default via 192.168.10.254&quot;</span>)</span><br><span class="line">    h2.cmd(<span class="string">&quot;ifconfig h2-eth0 192.168.10.2/24&quot;</span>)</span><br><span class="line">    h2.cmd(<span class="string">&quot;ip route add default via 192.168.10.254&quot;</span>)</span><br><span class="line">    h3.cmd(<span class="string">&quot;ifconfig h3-eth0 192.168.20.1/24&quot;</span>)</span><br><span class="line">    h3.cmd(<span class="string">&quot;ip route add default via 192.168.20.254&quot;</span>)</span><br><span class="line">    h4.cmd(<span class="string">&quot;ifconfig h4-eth0 192.168.20.2/24&quot;</span>)</span><br><span class="line">    h4.cmd(<span class="string">&quot;ip route add default via 192.168.20.254&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment"># start CommandLine Interface</span></span><br><span class="line">    CLI(net)</span><br><span class="line">    <span class="comment"># release net structure</span></span><br><span class="line">    net.stop()</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li>注: <ol>
<li><code>brctl</code> 用于管理网桥 在<code>bridge-utils</code>包下</li>
<li><code>brctl addbr &lt;br_name&gt;</code> 添加名为br_name的网桥</li>
<li><code>brctl addif &lt;br_name&gt; &lt;if_name&gt;</code> 添加名为if_name的接口到br_name的网桥</li>
<li>网桥不会自动up 需要<code>ifconfig &lt;br_name&gt; up</code></li>
</ol>
</li>
</ul>
<h2 id="6-Mininet-VLAN-配置"><a href="#6-Mininet-VLAN-配置" class="headerlink" title="6. Mininet VLAN 配置"></a>6. Mininet VLAN 配置</h2><p>虚拟局域网（VLAN）是一组逻辑上的设备和用户，这些设备和用户并不受物理位置的限制，可以根据功能、部门及应用等因素将它们组织起来，相互之间的通信就好像它们在同一个网段中一样，由此得名虚拟局域网</p>
<p>通过添加vlan 减少一个网桥</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">              r1</span><br><span class="line">              |  eth0.10</span><br><span class="line">              |  eth0.20</span><br><span class="line">              |            </span><br><span class="line">      +-------+------+</span><br><span class="line">br1:  | eth4.10      | eth4.20</span><br><span class="line">  +---|--------------|----+</span><br><span class="line">  |          mybr1        |</span><br><span class="line">  +---|--------------|----+</span><br><span class="line">      |              |</span><br><span class="line">   +--+--+        +--+--+</span><br><span class="line">   |     |        |     |</span><br><span class="line">   h1    h2       h3    h4</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="keyword">from</span> mininet.cli <span class="keyword">import</span> CLI</span><br><span class="line"><span class="keyword">from</span> mininet.net <span class="keyword">import</span> Mininet</span><br><span class="line"><span class="keyword">from</span> mininet.link <span class="keyword">import</span> Link,TCLink</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="string">&#x27;__main__&#x27;</span> == __name__:</span><br><span class="line">    net = Mininet(link=TCLink) <span class="comment"># Get a mininet object with TCLink</span></span><br><span class="line">    <span class="comment"># add hosts to net object</span></span><br><span class="line">    h1 = net.addHost(<span class="string">&#x27;h1&#x27;</span>)  </span><br><span class="line">    h2 = net.addHost(<span class="string">&#x27;h2&#x27;</span>)</span><br><span class="line">    h3 = net.addHost(<span class="string">&#x27;h3&#x27;</span>)</span><br><span class="line">    h4 = net.addHost(<span class="string">&#x27;h4&#x27;</span>)</span><br><span class="line">    br1 = net.addHost(<span class="string">&#x27;br1&#x27;</span>)</span><br><span class="line">    r1 = net.addHost(<span class="string">&#x27;r1&#x27;</span>)</span><br><span class="line">    <span class="comment"># create link between to hosts</span></span><br><span class="line">    net.addLink(h1,br1)</span><br><span class="line">    net.addLink(h2,br1)</span><br><span class="line">    net.addLink(h3,br1)</span><br><span class="line">    net.addLink(h4,br1)</span><br><span class="line">    net.addLink(br1,r1)</span><br><span class="line">    <span class="comment"># build net structure</span></span><br><span class="line">    net.build()</span><br><span class="line">    <span class="comment"># clear ip addr</span></span><br><span class="line">    h1.cmd(<span class="string">&quot;ifconfig h1-eth0 0&quot;</span>)</span><br><span class="line">    h2.cmd(<span class="string">&quot;ifconfig h2-eth0 0&quot;</span>)</span><br><span class="line">    h3.cmd(<span class="string">&quot;ifconfig h3-eth0 0&quot;</span>)</span><br><span class="line">    h4.cmd(<span class="string">&quot;ifconfig h4-eth0 0&quot;</span>)</span><br><span class="line">    r1.cmd(<span class="string">&quot;ifconfig r1-eth0 0&quot;</span>)</span><br><span class="line">    br1.cmd(<span class="string">&quot;ifconfig br1-eth0 0&quot;</span>)</span><br><span class="line">    br1.cmd(<span class="string">&quot;ifconfig br1-eth1 0&quot;</span>)</span><br><span class="line">    br1.cmd(<span class="string">&quot;ifconfig br1-eth2 0&quot;</span>)</span><br><span class="line">    br1.cmd(<span class="string">&quot;ifconfig br1-eth3 0&quot;</span>)</span><br><span class="line">    br1.cmd(<span class="string">&quot;ifconfig br1-eth4 0&quot;</span>)</span><br><span class="line">    <span class="comment"># config vlan</span></span><br><span class="line">    br1.cmd(<span class="string">&quot;vconfig add br1-eth4 10&quot;</span>) <span class="comment"># vlan br1-eth4.10</span></span><br><span class="line">    br1.cmd(<span class="string">&quot;vconfig add br1-eth4 20&quot;</span>) <span class="comment"># vlan br1-eth4.20</span></span><br><span class="line">    r1.cmd(<span class="string">&quot;vconfig add r1-eth0 10&quot;</span>) <span class="comment"># vlan r1-eth4.10</span></span><br><span class="line">    r1.cmd(<span class="string">&quot;vconfig add r1-eth0 20&quot;</span>) <span class="comment"># vlan r1-eth4.20</span></span><br><span class="line">    <span class="comment"># add bridge</span></span><br><span class="line">    br1.cmd(<span class="string">&quot;brctl addbr mybr10&quot;</span>)</span><br><span class="line">    br1.cmd(<span class="string">&quot;brctl addbr mybr20&quot;</span>)</span><br><span class="line">    <span class="comment"># add interface to bridge</span></span><br><span class="line">    br1.cmd(<span class="string">&quot;brctl addif mybr10 br1-eth0&quot;</span>)</span><br><span class="line">    br1.cmd(<span class="string">&quot;brctl addif mybr10 br1-eth1&quot;</span>)</span><br><span class="line">    br1.cmd(<span class="string">&quot;brctl addif mybr10 br1-eth4.10&quot;</span>)</span><br><span class="line">    br1.cmd(<span class="string">&quot;brctl addif mybr20 br1-eth2&quot;</span>)</span><br><span class="line">    br1.cmd(<span class="string">&quot;brctl addif mybr20 br1-eth3&quot;</span>)</span><br><span class="line">    br1.cmd(<span class="string">&quot;brctl addif mybr20 br1-eth4.20&quot;</span>)</span><br><span class="line">    <span class="comment"># set bridge and vlan up</span></span><br><span class="line">    br1.cmd(<span class="string">&quot;ifconfig br1-eth4.10 up&quot;</span>)</span><br><span class="line">    br1.cmd(<span class="string">&quot;ifconfig br1-eth4.20 up&quot;</span>)</span><br><span class="line">    r1.cmd(<span class="string">&quot;ifconfig r1-eth0.10 up&quot;</span>)</span><br><span class="line">    r1.cmd(<span class="string">&quot;ifconfig r1-eth0.20 up&quot;</span>)</span><br><span class="line">    br1.cmd(<span class="string">&quot;ifconfig mybr10 up&quot;</span>)</span><br><span class="line">    br1.cmd(<span class="string">&quot;ifconfig mybr20 up&quot;</span>)</span><br><span class="line">    <span class="comment"># set ip address and route</span></span><br><span class="line">    r1.cmd(<span class="string">&quot;ifconfig r1-eth0.10 192.168.10.254/24&quot;</span>)</span><br><span class="line">    r1.cmd(<span class="string">&quot;ifconfig r1-eth0.20 192.168.20.254/24&quot;</span>)</span><br><span class="line">    r1.cmd(<span class="string">&quot;echo 1 &gt; /proc/sys/net/ipv4/ip_forward&quot;</span>)</span><br><span class="line">    h1.cmd(<span class="string">&quot;ifconfig h1-eth0 192.168.10.1/24&quot;</span>)</span><br><span class="line">    h1.cmd(<span class="string">&quot;ip route add default via 192.168.10.254&quot;</span>)</span><br><span class="line">    h2.cmd(<span class="string">&quot;ifconfig h2-eth0 192.168.10.2/24&quot;</span>)</span><br><span class="line">    h2.cmd(<span class="string">&quot;ip route add default via 192.168.10.254&quot;</span>)</span><br><span class="line">    h3.cmd(<span class="string">&quot;ifconfig h3-eth0 192.168.20.1/24&quot;</span>)</span><br><span class="line">    h3.cmd(<span class="string">&quot;ip route add default via 192.168.20.254&quot;</span>)</span><br><span class="line">    h4.cmd(<span class="string">&quot;ifconfig h4-eth0 192.168.20.2/24&quot;</span>)</span><br><span class="line">    h4.cmd(<span class="string">&quot;ip route add default via 192.168.20.254&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment"># start CommandLine Interface</span></span><br><span class="line">    CLI(net)</span><br><span class="line">    <span class="comment"># release net structure</span></span><br><span class="line">    net.stop()</span><br></pre></td></tr></table></figure>
<p><strong>数据包在穿过网桥送往路由器时会被打上一个特殊标签</strong><br><em>从vlan.10发往router时</em><br><img src="/2021/07/15/SDN/6-vlan-10.png" class="" title="vlan10"><br><em>从vlan.20发往router时</em><br><img src="/2021/07/15/SDN/6-vlan-20.png" class="" title="vlan20"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://alexzhu2001.github.io/AlexZhu2001/2021/04/21/LeetCode-91-%E8%A7%A3%E7%A0%81%E6%96%B9%E6%B3%95/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/head.png">
      <meta itemprop="name" content="Alex Zhu">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Alex's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/04/21/LeetCode-91-%E8%A7%A3%E7%A0%81%E6%96%B9%E6%B3%95/" class="post-title-link" itemprop="url">LeetCode-91.解码方法</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-04-21 13:19:49" itemprop="dateCreated datePublished" datetime="2021-04-21T13:19:49+08:00">2021-04-21</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-07-18 21:17:06" itemprop="dateModified" datetime="2021-07-18T21:17:06+08:00">2021-07-18</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="LeetCode-91-解码方法"><a href="#LeetCode-91-解码方法" class="headerlink" title="LeetCode-91.解码方法"></a>LeetCode-91.解码方法</h1><h2 id="问题描述"><a href="#问题描述" class="headerlink" title="问题描述"></a>问题描述</h2><img src="/2021/04/21/LeetCode-91-%E8%A7%A3%E7%A0%81%E6%96%B9%E6%B3%95/question.png" class="" title="question">
<h2 id="思路及解决方法"><a href="#思路及解决方法" class="headerlink" title="思路及解决方法"></a>思路及解决方法</h2><p>动态规划<br>设 $f_i$ 是 $s[1:i]$ 对应字符串对应的解码方法次数(下标从1开始)<br>对于 $f_i$</p>
<ol>
<li>只使用了一个字符 <code>s[i]</code> 解码 若$s[i] \neq 0$ 则$s[i]$一定与A~I中一个对应<br> 状态转移方程为:<script type="math/tex; mode=display">
 f_i = f_{i-1} \quad s[i] \neq 0</script></li>
<li>使用了两个字符 <code>s[i]</code> 和 <code>s[i-1]</code> 此时$s[i-1] \neq 0$ 且s[i]和s[i-1]组成的整数必须小于26<br> 状态转移方程为:<script type="math/tex; mode=display">
 f_i = f_{i-2} \quad s[i-1] \neq 0 并且 10 \cdot s[i-1]+s[i] \leq 26</script> 需要$i&gt;1$才能转移 </li>
</ol>
<p>边界条件 $f_0=1$<br><strong>空字符串可以有 1 种解码方法 解码出一个空字符串</strong></p>
<p>注意到 $f<em>i$ 只与 $f</em>{i-1}$ 和 $f_{i-2}$ 有关 我们只用三个变量即可</p>
<p>注意:<strong>C++下标从零开始 注意减去一</strong></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">numDecodings</span><span class="params">(string s)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n=s.<span class="built_in">size</span>();</span><br><span class="line">        <span class="keyword">int</span> prev1=<span class="number">1</span>,prev2=<span class="number">0</span>,now=<span class="number">0</span>; </span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">            prev1 -&gt; f[i-1]</span></span><br><span class="line"><span class="comment">            prev2 -&gt; f[i-2]</span></span><br><span class="line"><span class="comment">            now -&gt; f[i]</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</span><br><span class="line">            now=<span class="number">0</span>;</span><br><span class="line">            <span class="keyword">if</span>(s[i<span class="number">-1</span>]!=<span class="string">&#x27;0&#x27;</span>)&#123;</span><br><span class="line">                now+=prev1;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(i&gt;<span class="number">1</span>&amp;&amp;s[i<span class="number">-2</span>]!=<span class="string">&#x27;0&#x27;</span>&amp;&amp;((s[i<span class="number">-2</span>]-<span class="string">&#x27;0&#x27;</span>)*<span class="number">10</span>+s[i<span class="number">-1</span>]-<span class="string">&#x27;0&#x27;</span>)&lt;=<span class="number">26</span>)&#123;</span><br><span class="line">                now+=prev2;</span><br><span class="line">            &#125;</span><br><span class="line">            prev2=prev1;</span><br><span class="line">            prev1=now;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> now;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<img src="/2021/04/21/LeetCode-91-%E8%A7%A3%E7%A0%81%E6%96%B9%E6%B3%95/1.png" class="" title="AC">
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://alexzhu2001.github.io/AlexZhu2001/2021/04/20/LeetCode-169-%E5%A4%9A%E6%95%B0%E5%85%83%E7%B4%A0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/head.png">
      <meta itemprop="name" content="Alex Zhu">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Alex's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/04/20/LeetCode-169-%E5%A4%9A%E6%95%B0%E5%85%83%E7%B4%A0/" class="post-title-link" itemprop="url">LeetCode-169.多数元素</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-04-20 22:09:00" itemprop="dateCreated datePublished" datetime="2021-04-20T22:09:00+08:00">2021-04-20</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-07-18 21:17:06" itemprop="dateModified" datetime="2021-07-18T21:17:06+08:00">2021-07-18</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="LeetCode-169-多数元素"><a href="#LeetCode-169-多数元素" class="headerlink" title="LeetCode-169.多数元素"></a>LeetCode-169.多数元素</h1><h2 id="问题描述"><a href="#问题描述" class="headerlink" title="问题描述"></a>问题描述</h2><img src="/2021/04/20/LeetCode-169-%E5%A4%9A%E6%95%B0%E5%85%83%E7%B4%A0/question.png" class="" title="question">
<h2 id="思路与解决办法"><a href="#思路与解决办法" class="headerlink" title="思路与解决办法"></a>思路与解决办法</h2><h3 id="1-哈希表"><a href="#1-哈希表" class="headerlink" title="1. 哈希表"></a>1. <strong>哈希表</strong></h3><pre><code>统计每个元素出现的次数 最后取最大的那个即可
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">majorityElement</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">        unordered_map&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; hashmap;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> i:nums)&#123;</span><br><span class="line">            ++hashmap[i];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> max=<span class="number">0</span>,max_i=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> it=hashmap.<span class="built_in">begin</span>();it!=hashmap.<span class="built_in">end</span>();it++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(it-&gt;second&gt;max)&#123;</span><br><span class="line">                max=it-&gt;second;</span><br><span class="line">                max_i=it-&gt;first;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> max_i;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

* 时间复杂度:$O(n)$
* 空间复杂度:$O(n)$

&#123;% asset_img 1.png resolution_1 %&#125;
</code></pre><h3 id="2-排序"><a href="#2-排序" class="headerlink" title="2. 排序"></a>2. <strong>排序</strong></h3><pre><code>对元素先排序 则$\frac&#123;n&#125;&#123;2&#125;$处的元素一定是众数
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">majorityElement</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">sort</span>(nums.<span class="built_in">begin</span>(),nums.<span class="built_in">end</span>());</span><br><span class="line">        <span class="keyword">return</span> nums.<span class="built_in">at</span>(nums.<span class="built_in">size</span>()/<span class="number">2</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
* 时间复杂度:$O(n\log&#123;n&#125;)$
* 空间复杂度:$O(n\log&#123;n&#125;)$

&#123;% asset_img 2.png resolution_2 %&#125;
</code></pre><h3 id="3-随机化"><a href="#3-随机化" class="headerlink" title="3. 随机化"></a>3. <strong>随机化</strong></h3><pre><code>随机挑选元素 判断是不是众数
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">majorityElement</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n=nums.<span class="built_in">size</span>();</span><br><span class="line">        <span class="keyword">int</span> halfn=n/<span class="number">2</span>;</span><br><span class="line">        <span class="keyword">while</span>(<span class="number">1</span>)&#123;</span><br><span class="line">            <span class="keyword">int</span> cand=nums[<span class="built_in">rand</span>()%n];</span><br><span class="line">            <span class="keyword">if</span>(<span class="built_in">count</span>(nums,cand)&gt;halfn) <span class="keyword">return</span> cand;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">count</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt; &amp;nums,<span class="keyword">int</span> num)</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> c=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> i:nums)&#123;</span><br><span class="line">            c+=i==num?<span class="number">1</span>:<span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> c;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

* 时间复杂度:
    理论上最坏情况的时间复杂度是$O(\infty)$ 因为我们可能一直找不到众数
    但是 期望为线性值 
    计算方法如下
    $$
    E\leq&#123;E_&#123;frac&#123;n&#125;&#123;2&#125;&#125;&#125;
    =\lim_&#123;n \to \infty&#125;&#123;\sum_&#123;i=1&#125;^&#123;n&#125;&#123;i*\frac&#123;1&#125;&#123;2^i&#125;&#125;&#125;
    =2
    $$
    每次取随机数后 仍需要$O(n)$时间来判断是不是众数 所以期望的时间复杂度为$O(n)$
* 空间复杂度:$O(1)$

&#123;% asset_img 3.png resolution_3 %&#125;
</code></pre><h3 id="4-分治法"><a href="#4-分治法" class="headerlink" title="4. 分治法"></a>4. <strong>分治法</strong></h3><pre><code>易得 若一个数是数组的众数 则他是左半边数组的众数或者是右半边数组的众数
可以使用反证法证明 假设一个数`a`他既不是是左半边数组的众数也不是是右半边数组的众数
根据题目定义 `count(a)`&lt;$\frac&#123;l&#125;&#123;2&#125;+\frac&#123;r&#125;&#123;2&#125;$ 其中`l`和`r`分别是左右两边长度
则`count(a)`&lt;$\frac&#123;l+r&#125;&#123;2&#125;$ 他也不是数组的众数 产生矛盾

我们递归求解 长度为 1 的子数组中唯一的数显然是众数 如果回溯后某区间的长度大于1 我们必须将左右子区间的值合并 如果它们的众数相同 那么显然这一段区间的众数是它们相同的值 
否则 我们需要比较两个众数在整个区间内出现的次数来决定该区间的众数

<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">count</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt; &amp;nums,<span class="keyword">int</span> target,<span class="keyword">int</span> lo,<span class="keyword">int</span> hi)</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> c=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=lo;i&lt;=hi;i++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(nums[i]==target) c++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> c;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">work</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt; &amp;nums,<span class="keyword">int</span> lo,<span class="keyword">int</span> hi)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(lo==hi) <span class="keyword">return</span> nums[lo];</span><br><span class="line">        <span class="keyword">int</span> mid=lo+(hi-lo)/<span class="number">2</span>;</span><br><span class="line">        <span class="keyword">int</span> left=<span class="built_in">work</span>(nums,lo,mid);</span><br><span class="line">        <span class="keyword">int</span> right=<span class="built_in">work</span>(nums,mid+<span class="number">1</span>,hi);</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">count</span>(nums,left,lo,hi)&gt;(hi-lo+<span class="number">1</span>)/<span class="number">2</span>)</span><br><span class="line">            <span class="keyword">return</span> left;</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">count</span>(nums,right,lo,hi)&gt;(hi-lo+<span class="number">1</span>)/<span class="number">2</span>)</span><br><span class="line">            <span class="keyword">return</span> right;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">majorityElement</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">work</span>(nums,<span class="number">0</span>,nums.<span class="built_in">size</span>()<span class="number">-1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
* 时间复杂度:
    函数将求解2个长度为$\frac&#123;n&#125;&#123;2&#125;$的子问题 并作两遍扫描 即
    $$
        O(n)=2*T(\frac&#123;n&#125;&#123;2&#125;)+2n
    $$
    根据[主定理](https://baike.baidu.com/item/%E4%B8%BB%E5%AE%9A%E7%90%86/3463232?fr=aladdin)
    $$
        T(n)=\Theta(n\log_&#123;b&#125;&#123;a&#125;\log&#123;n&#125;)=\Theta(n\log_&#123;2&#125;&#123;2&#125;\log&#123;n&#125;)=\Theta(n\log&#123;n&#125;)
    $$ 
    即为$O(n\log&#123;n&#125;)$

* 空间复杂度:$O(\log&#123;n&#125;)$ 来自于递归的栈消耗 数组长度变为1前递归$\log&#123;n&#125;$次

&#123;% asset_img 4.png resolution_4 %&#125;
</code></pre><h3 id="5-Boyer-Moore-投票算法"><a href="#5-Boyer-Moore-投票算法" class="headerlink" title="5. Boyer-Moore 投票算法"></a>5. <strong>Boyer-Moore 投票算法</strong></h3><pre><code>维护一个候选数字 `cand` 和他出现的次数 `count` `cand`初始化为任意值 `count`初始化为0
遍历数组 对于每个元素`x`
- 若`count==0` 则`cand=x`
- 继续判断`x`
    - 若`x==cand` 则`count+=1`
    - 否则 `count-=1`
遍历完成后 `cand` 的值就是众数

<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">majorityElement</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> cand=<span class="number">0</span>,count=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> x:nums)&#123;</span><br><span class="line">            <span class="keyword">if</span>(count==<span class="number">0</span>) cand=x;</span><br><span class="line">            <span class="keyword">if</span>(x==cand) count++;</span><br><span class="line">            <span class="keyword">else</span> count--;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> cand;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
* 时间复杂度: $O(n)$
* 空间复杂度: $O(1)$

&#123;% asset_img 5.png resolution_5 %&#125;
</code></pre>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://alexzhu2001.github.io/AlexZhu2001/2021/04/18/LeetCode-354-%E4%BF%84%E7%BD%97%E6%96%AF%E5%A5%97%E5%A8%83%E4%BF%A1%E5%B0%81%E9%97%AE%E9%A2%98/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/head.png">
      <meta itemprop="name" content="Alex Zhu">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Alex's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/04/18/LeetCode-354-%E4%BF%84%E7%BD%97%E6%96%AF%E5%A5%97%E5%A8%83%E4%BF%A1%E5%B0%81%E9%97%AE%E9%A2%98/" class="post-title-link" itemprop="url">LeetCode.354.俄罗斯套娃信封问题</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-04-18 11:56:48" itemprop="dateCreated datePublished" datetime="2021-04-18T11:56:48+08:00">2021-04-18</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-07-18 21:17:06" itemprop="dateModified" datetime="2021-07-18T21:17:06+08:00">2021-07-18</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="LeetCode-354-俄罗斯套娃信封问题"><a href="#LeetCode-354-俄罗斯套娃信封问题" class="headerlink" title="LeetCode.354.俄罗斯套娃信封问题"></a>LeetCode.354.俄罗斯套娃信封问题</h1><h2 id="问题描述"><a href="#问题描述" class="headerlink" title="问题描述"></a>问题描述</h2><img src="/2021/04/18/LeetCode-354-%E4%BF%84%E7%BD%97%E6%96%AF%E5%A5%97%E5%A8%83%E4%BF%A1%E5%B0%81%E9%97%AE%E9%A2%98/question.png" class="" title="question">
<h2 id="解题思路及代码"><a href="#解题思路及代码" class="headerlink" title="解题思路及代码"></a>解题思路及代码</h2><p>题目的本质是<strong>找出一个最长的二维数组序列 满足其在两个维度上都严格递增(不包含相等的情况)</strong></p>
<h3 id="思路一"><a href="#思路一" class="headerlink" title="思路一"></a><strong>思路一</strong></h3><p>两个维度都使用 <em>排序法</em> 使两个维度都递增 然后使用动态规划</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">maxEnvelopes</span><span class="params">(vector&lt;vector&lt;<span class="keyword">int</span>&gt;&gt;&amp; envelopes)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n=envelopes.<span class="built_in">size</span>();</span><br><span class="line">        <span class="keyword">if</span>(!n) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">sort</span>(envelopes.<span class="built_in">begin</span>(),envelopes.<span class="built_in">end</span>()); <span class="comment">//两个维度升序排序</span></span><br><span class="line">        <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">dp</span><span class="params">(n,<span class="number">1</span>)</span></span>; <span class="comment">//动态规划记忆化数组</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;i++)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;n;j++)&#123;</span><br><span class="line">                <span class="keyword">if</span>(envelopes[i][<span class="number">0</span>]&gt;envelopes[j][<span class="number">0</span>]&amp;&amp;</span><br><span class="line">                   envelopes[i][<span class="number">1</span>]&gt;envelopes[j][<span class="number">1</span>])&#123; <span class="comment">//找到符合条件的信封</span></span><br><span class="line">                    dp[i]=<span class="built_in">max</span>(dp[i],dp[j]+<span class="number">1</span>); <span class="comment">//取较大值</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> *<span class="built_in">max_element</span>(dp.<span class="built_in">begin</span>(),dp.<span class="built_in">end</span>()); <span class="comment">//直接返回最大值</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<ul>
<li>时间复杂度 $O(n^2)$</li>
<li>空间复杂度 $O(n)$</li>
</ul>
<img src="/2021/04/18/LeetCode-354-%E4%BF%84%E7%BD%97%E6%96%AF%E5%A5%97%E5%A8%83%E4%BF%A1%E5%B0%81%E9%97%AE%E9%A2%98/method-one-pass.png" class="" title="pass">
<ul>
<li><strong>该解法在部分语言下会超时</strong></li>
</ul>
<h3 id="思路二"><a href="#思路二" class="headerlink" title="思路二 "></a><strong>思路二 </strong></h3><p>第一个维度<em>升序</em> 第二个维度<em>降序</em> 最后动态规划</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">maxEnvelopes</span><span class="params">(vector&lt;vector&lt;<span class="keyword">int</span>&gt;&gt;&amp; envelopes)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n=envelopes.<span class="built_in">size</span>();</span><br><span class="line">        <span class="keyword">if</span>(!n) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">sort</span>(envelopes.<span class="built_in">begin</span>(),envelopes.<span class="built_in">end</span>(),[](<span class="keyword">auto</span> &amp;a1,<span class="keyword">auto</span> &amp;a2)&#123;</span><br><span class="line">            <span class="keyword">return</span> a1[<span class="number">0</span>]&lt;a2[<span class="number">0</span>]||(a1[<span class="number">0</span>]==a2[<span class="number">0</span>]&amp;&amp;a1[<span class="number">1</span>]&gt;a2[<span class="number">1</span>]);</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">            使用C++的匿名函数[]()&#123;&#125; 传递sort的第三个参数 该参数用于判断是否需要交换两个值</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">        <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">dp</span><span class="params">(n,<span class="number">1</span>)</span></span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;i++)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;i;j++)&#123;</span><br><span class="line">                <span class="keyword">if</span>(envelopes[j][<span class="number">1</span>]&lt;envelopes[i][<span class="number">1</span>])&#123; <span class="comment">//动态规划第二维度 </span></span><br><span class="line">                    dp[i]=<span class="built_in">max</span>(dp[i],dp[j]+<span class="number">1</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> *<span class="built_in">max_element</span>(dp.<span class="built_in">begin</span>(),dp.<span class="built_in">end</span>());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<ul>
<li>时间复杂度 $O(n^2)$ 其中<code>n</code>是数组<code>envelopes</code>的长度 排序的时间复杂度为$O(n\log{n})$ 动态规划的时间复杂度为$O(n^2)$</li>
<li>空间复杂度 $O(n)$</li>
</ul>
<img src="/2021/04/18/LeetCode-354-%E4%BF%84%E7%BD%97%E6%96%AF%E5%A5%97%E5%A8%83%E4%BF%A1%E5%B0%81%E9%97%AE%E9%A2%98/method-two-pass.png" class="" title="pass">
<h3 id="思路三"><a href="#思路三" class="headerlink" title="思路三 "></a><strong>思路三 </strong></h3><p>在思路二的基础上 排序后维护一个数组$f$ 对<code>envelopes</code>二分搜索<br>考虑当前元素$h_i$</p>
<ul>
<li>若$h_i$大于f中最大值 则$h_i$可以连接在之后成为一个更长的严格递增序列</li>
<li>否则我们找出 $f$ 中比 $h_i$​ 严格小的最大的元素 $f[j_0]$ 即 $f[j_0]&lt;h_i&lt;=f[j_0+1]$ 那么 $h_i$​ 可以接在$f[j_0]$之后，形成一个长度为$j_0+1$的严格递增子序列，因此需要对$f[j_0+1]$进行更新<script type="math/tex; mode=display">f[j_0+1]=h_i</script></li>
</ul>
<p>最后$f$的长度即所求</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">maxEnvelopes</span><span class="params">(vector&lt;vector&lt;<span class="keyword">int</span>&gt;&gt;&amp; envelopes)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n=envelopes.<span class="built_in">size</span>();</span><br><span class="line">        <span class="built_in">sort</span>(envelopes.<span class="built_in">begin</span>(),envelopes.<span class="built_in">end</span>(),[](<span class="keyword">auto</span> a1,<span class="keyword">auto</span> a2)&#123;</span><br><span class="line">            <span class="keyword">return</span> a1[<span class="number">0</span>]&lt;a2[<span class="number">0</span>]||(a1[<span class="number">0</span>]==a2[<span class="number">0</span>]&amp;&amp;a1[<span class="number">1</span>]&gt;a2[<span class="number">1</span>]);</span><br><span class="line">        &#125;);</span><br><span class="line">        vector&lt;<span class="keyword">int</span>&gt; f;</span><br><span class="line">        f.<span class="built_in">emplace_back</span>(envelopes[<span class="number">0</span>][<span class="number">1</span>]);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;n;i++)&#123;</span><br><span class="line">            <span class="keyword">int</span> num=envelopes[i][<span class="number">1</span>];</span><br><span class="line">            <span class="keyword">if</span>(num&gt;f.<span class="built_in">back</span>())&#123;</span><br><span class="line">                f.<span class="built_in">emplace_back</span>(num);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">auto</span> it=<span class="built_in">lower_bound</span>(f.<span class="built_in">begin</span>(),f.<span class="built_in">end</span>(),num);</span><br><span class="line">                *it=num;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> f.<span class="built_in">size</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<img src="/2021/04/18/LeetCode-354-%E4%BF%84%E7%BD%97%E6%96%AF%E5%A5%97%E5%A8%83%E4%BF%A1%E5%B0%81%E9%97%AE%E9%A2%98/method-thr-pass.png" class="" title="pass">
<ul>
<li>时间复杂度 $O(n\log{n})$ 其中<code>n</code>是数组<code>envelopes</code>的长度 排序的时间复杂度为$O(n\log{n})$ 动态规划的时间复杂度为$O(n\log{n})$</li>
<li>空间复杂度 $O(n)$ </li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://alexzhu2001.github.io/AlexZhu2001/2021/04/16/LeetCode87-%E6%89%B0%E4%B9%B1%E5%AD%97%E7%AC%A6%E4%B8%B2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/head.png">
      <meta itemprop="name" content="Alex Zhu">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Alex's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/04/16/LeetCode87-%E6%89%B0%E4%B9%B1%E5%AD%97%E7%AC%A6%E4%B8%B2/" class="post-title-link" itemprop="url">LeetCode87.扰乱字符串</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-04-16 12:20:29" itemprop="dateCreated datePublished" datetime="2021-04-16T12:20:29+08:00">2021-04-16</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-07-18 21:17:06" itemprop="dateModified" datetime="2021-07-18T21:17:06+08:00">2021-07-18</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="LeetCode87-扰乱字符串"><a href="#LeetCode87-扰乱字符串" class="headerlink" title="LeetCode87.扰乱字符串"></a>LeetCode87.扰乱字符串</h1><div style="font-size:small">  
部分转载自以下链接:</br>
<a target="_blank" rel="noopener" href="https://leetcode-cn.com/problems/scramble-string/solution/rao-luan-zi-fu-chuan-by-leetcode-solutio-8r9t/">LeetCode-Solution</a></br>
<a target="_blank" rel="noopener" href="https://leetcode-cn.com/problems/scramble-string/solution/miao-dong-de-qu-jian-xing-dpsi-lu-by-sha-yu-la-jia/">jerry_nju</a></br>
</div>

<hr>
<h2 id="题目描述"><a href="#题目描述" class="headerlink" title="题目描述"></a>题目描述</h2><p>使用下面描述的算法可以扰乱字符串 s 得到字符串 t :</p>
<ol>
<li>如果字符串的长度为 1 ,算法停止</li>
<li>如果字符串的长度 &gt; 1 ,执行下述步骤：<ol>
<li>在一个随机下标处将字符串分割成两个非空的子字符串。即，如果已知字符串 s ，则可以将其分成两个子字符串 x 和 y ，且满足 s = x + y 。</li>
<li>随机 决定是要「交换两个子字符串」还是要「保持这两个子字符串的顺序不变」。即，在执行这一步骤之后，s 可能是 s = x + y 或者 s = y + x 。</li>
<li>在 x 和 y 这两个子字符串上继续从步骤 1 开始递归执行此算法.</li>
</ol>
</li>
</ol>
<p>给你两个 长度相等 的字符串 s1 和 s2，判断 s2 是否是 s1 的扰乱字符串。如果是，返回 true ；否则，返回 false .</p>
<h2 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h2><p><strong>示例一</strong><br><figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">输入：<span class="built_in">s1</span> = <span class="string">&quot;great&quot;</span>, <span class="built_in">s2</span> = <span class="string">&quot;rgeat&quot;</span></span><br><span class="line">输出：true</span><br><span class="line">解释：<span class="built_in">s1</span> 上可能发生的一种情形是：</span><br><span class="line"><span class="string">&quot;great&quot;</span> --&gt; <span class="string">&quot;gr/eat&quot;</span> <span class="comment">// 在一个随机下标处分割得到两个子字符串</span></span><br><span class="line"><span class="string">&quot;gr/eat&quot;</span> --&gt; <span class="string">&quot;gr/eat&quot;</span> <span class="comment">// 随机决定：「保持这两个子字符串的顺序不变」</span></span><br><span class="line"><span class="string">&quot;gr/eat&quot;</span> --&gt; <span class="string">&quot;g/r / e/at&quot;</span> <span class="comment">// 在子字符串上递归执行此算法。两个子字符串分别在随机下标处进行一轮分割</span></span><br><span class="line"><span class="string">&quot;g/r / e/at&quot;</span> --&gt; <span class="string">&quot;r/g / e/at&quot;</span> <span class="comment">// 随机决定：第一组「交换两个子字符串」，第二组「保持这两个子字符串的顺序不变」</span></span><br><span class="line"><span class="string">&quot;r/g / e/at&quot;</span> --&gt; <span class="string">&quot;r/g / e/ a/t&quot;</span> <span class="comment">// 继续递归执行此算法，将 &quot;at&quot; 分割得到 &quot;a/t&quot;</span></span><br><span class="line"><span class="string">&quot;r/g / e/ a/t&quot;</span> --&gt; <span class="string">&quot;r/g / e/ a/t&quot;</span> <span class="comment">// 随机决定：「保持这两个子字符串的顺序不变」</span></span><br><span class="line">算法终止，结果字符串和 <span class="built_in">s2</span> 相同，都是 <span class="string">&quot;rgeat&quot;</span></span><br><span class="line">这是一种能够扰乱 <span class="built_in">s1</span> 得到 <span class="built_in">s2</span> 的情形，可以认为 <span class="built_in">s2</span> 是 <span class="built_in">s1</span> 的扰乱字符串，返回 true</span><br></pre></td></tr></table></figure><br><strong>示例二</strong><br><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入：<span class="attr">s1</span> = <span class="string">&quot;abcde&quot;</span>, <span class="attr">s2</span> = <span class="string">&quot;caebd&quot;</span></span><br><span class="line">输出：<span class="literal">false</span></span><br></pre></td></tr></table></figure><br><strong>示例三</strong><br><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入：<span class="attr">s1</span> = <span class="string">&quot;a&quot;</span>, <span class="attr">s2</span> = <span class="string">&quot;a&quot;</span></span><br><span class="line">输出：<span class="literal">true</span></span><br></pre></td></tr></table></figure></p>
<h2 id="思路与方法"><a href="#思路与方法" class="headerlink" title="思路与方法"></a>思路与方法</h2><p>显然 若s和t长度不同 则必不能由s变化为t<br>若长度相同 则存在一个分割点<code>i1</code>,使<code>s</code>分割为<code>s1</code>和<code>s2</code>,一个分割点<code>i2</code>,使<code>t</code>分割为<code>t1</code>和<code>t2</code></p>
<p>满足 </p>
<ul>
<li>没交换 s1-&gt;t1 s2-&gt;t2</li>
<li>交换了 s2-&gt;t1 s1-&gt;t2</li>
</ul>
<p><strong>子问题</strong></p>
<p>分别讨论两种情况<br><img src="/2021/04/16/LeetCode87-%E6%89%B0%E4%B9%B1%E5%AD%97%E7%AC%A6%E4%B8%B2/1.png" class="" title="pic"></p>
<p><strong>记忆化搜索数组</strong><br>可先设记忆化搜索数组为<code>mem[i][j][k][h]</code><br>又因为s和t长度的关系 <code>j-i=h-k</code><br>则可将数组降低为三维 <code>mem[i][j][l]</code><br>表示从字符串 <code>s</code> 中 <code>i</code> 开始长度为 <code>l</code> 的字符串是否能变换为从字符串 <code>t</code> 中 <code>j</code> 开始长度为 <code>l</code> 的字符串</p>
<p><strong>状态转移方程</strong></p>
<script type="math/tex; mode=display">
\begin{align*}
&dp[i][j][l]=\\\\
&\mathop{V}\limits_{w=1}\limits^{l-1}{(dp[i][j][w]\&\&dp[i+w][j+w][l-w])} || \\\\
&\mathop{V}\limits_{w=1}\limits^{l-1}{(dp[i][j+l-w][w]\&\&dp[i+w][j][l-w])}
\end{align*}</script><p><strong>初始条件</strong><br>对于长度为1的串 只有相等才能变换得到 相等为 <code>true</code> 不相等为 <code>false</code></p>
<h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="keyword">int</span> mem[<span class="number">30</span>][<span class="number">30</span>][<span class="number">31</span>];</span><br><span class="line">    string s1,s2;</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">check</span><span class="params">(<span class="keyword">int</span> i1,<span class="keyword">int</span> i2,<span class="keyword">int</span> l)</span></span>&#123;</span><br><span class="line">        unordered_map&lt;<span class="keyword">char</span>,<span class="keyword">int</span>&gt; freq;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=i1;i&lt;i1+l;i++)&#123;</span><br><span class="line">            freq[s1[i]]+=<span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=i2;i&lt;i2+l;i++)&#123;</span><br><span class="line">            freq[s2[i]]-=<span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> it=freq.<span class="built_in">begin</span>();it!=freq.<span class="built_in">end</span>();it++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(it-&gt;second!=<span class="number">0</span>)<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> i1,<span class="keyword">int</span> i2,<span class="keyword">int</span> l)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(mem[i1][i2][l])</span><br><span class="line">            <span class="keyword">return</span> mem[i1][i2][l]==<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span>(s1.<span class="built_in">substr</span>(i1,l)==s2.<span class="built_in">substr</span>(i2,l))&#123;</span><br><span class="line">            mem[i1][i2][l]=<span class="number">1</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(!<span class="built_in">check</span>(i1,i2,l))&#123;</span><br><span class="line">            mem[i1][i2][l]=<span class="number">-1</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;l;i++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="built_in">dfs</span>(i1,i2,i)&amp;&amp;<span class="built_in">dfs</span>(i1+i,i2+i,l-i))&#123;</span><br><span class="line">                mem[i1][i2][l]=<span class="number">1</span>;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(<span class="built_in">dfs</span>(i1,i2+l-i,i)&amp;&amp;<span class="built_in">dfs</span>(i1+i,i2,l-i))&#123;</span><br><span class="line">                mem[i1][i2][l]=<span class="number">1</span>;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        mem[i1][i2][l]=<span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">isScramble</span><span class="params">(string s1, string s2)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">memset</span>(mem,<span class="number">0</span>,<span class="built_in"><span class="keyword">sizeof</span></span>(mem));</span><br><span class="line">        <span class="keyword">this</span>-&gt;s1=s1;</span><br><span class="line">        <span class="keyword">this</span>-&gt;s2=s2;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">dfs</span>(<span class="number">0</span>,<span class="number">0</span>,s1.<span class="built_in">size</span>());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://alexzhu2001.github.io/AlexZhu2001/2021/04/15/LeetCode-%E6%A0%88%E7%9A%84%E6%9C%80%E5%B0%8F%E5%80%BC/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/head.png">
      <meta itemprop="name" content="Alex Zhu">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Alex's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/04/15/LeetCode-%E6%A0%88%E7%9A%84%E6%9C%80%E5%B0%8F%E5%80%BC/" class="post-title-link" itemprop="url">LeetCode.栈的最小值</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-04-15 13:48:14" itemprop="dateCreated datePublished" datetime="2021-04-15T13:48:14+08:00">2021-04-15</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-07-18 21:17:06" itemprop="dateModified" datetime="2021-07-18T21:17:06+08:00">2021-07-18</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="栈的最小值"><a href="#栈的最小值" class="headerlink" title="栈的最小值"></a>栈的最小值</h1><h2 id="题目描述"><a href="#题目描述" class="headerlink" title="题目描述"></a>题目描述</h2><p>请设计一个栈，除了常规栈支持的pop与push函数以外，还支持min函数，该函数返回栈元素中的最小值。执行push、pop和min操作的时间复杂度必须为O(1)。</p>
<h2 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">MinStack minStack = <span class="keyword">new</span> MinStack();</span><br><span class="line">minStack.push(<span class="number">-2</span>);</span><br><span class="line">minStack.push(<span class="number">0</span>);</span><br><span class="line">minStack.push(<span class="number">-3</span>);</span><br><span class="line">minStack.getMin();   --&gt; 返回 <span class="number">-3.</span></span><br><span class="line">minStack.pop();</span><br><span class="line">minStack.top();      --&gt; 返回 <span class="number">0.</span></span><br><span class="line">minStack.getMin();   --&gt; 返回 <span class="number">-2.</span></span><br></pre></td></tr></table></figure>
<h2 id="解题方法"><a href="#解题方法" class="headerlink" title="解题方法"></a>解题方法</h2><p>维护两个栈 一个存放数据 一个存放当前最小值</p>
<h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MinStack</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">/** initialize your data structure here. */</span></span><br><span class="line">    vector&lt;<span class="keyword">int</span>&gt; min;</span><br><span class="line">    vector&lt;<span class="keyword">int</span>&gt; vec;</span><br><span class="line">    <span class="built_in">MinStack</span>() &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">push</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">        vec.<span class="built_in">push_back</span>(x);</span><br><span class="line">        <span class="keyword">if</span>(min.<span class="built_in">size</span>()==<span class="number">0</span>) min.<span class="built_in">push_back</span>(x);</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">int</span> l=min.<span class="built_in">at</span>(min.<span class="built_in">size</span>()<span class="number">-1</span>);</span><br><span class="line">            min.<span class="built_in">push_back</span>(l&gt;x?x:l);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">pop</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        vec.<span class="built_in">pop_back</span>();</span><br><span class="line">        min.<span class="built_in">pop_back</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">top</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> x=vec.<span class="built_in">at</span>(vec.<span class="built_in">size</span>()<span class="number">-1</span>);</span><br><span class="line">        <span class="keyword">return</span> x;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">getMin</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> *(min.<span class="built_in">end</span>()<span class="number">-1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Your MinStack object will be instantiated and called as such:</span></span><br><span class="line"><span class="comment"> * MinStack* obj = new MinStack();</span></span><br><span class="line"><span class="comment"> * obj-&gt;push(x);</span></span><br><span class="line"><span class="comment"> * obj-&gt;pop();</span></span><br><span class="line"><span class="comment"> * int param_3 = obj-&gt;top();</span></span><br><span class="line"><span class="comment"> * int param_4 = obj-&gt;getMin();</span></span><br><span class="line"><span class="comment"> */</span></span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://alexzhu2001.github.io/AlexZhu2001/2021/03/30/AHP/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/head.png">
      <meta itemprop="name" content="Alex Zhu">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Alex's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/03/30/AHP/" class="post-title-link" itemprop="url">AHP</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-03-30 21:52:34" itemprop="dateCreated datePublished" datetime="2021-03-30T21:52:34+08:00">2021-03-30</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-07-18 21:17:06" itemprop="dateModified" datetime="2021-07-18T21:17:06+08:00">2021-07-18</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="层次分析法-AHP"><a href="#层次分析法-AHP" class="headerlink" title="层次分析法 AHP"></a>层次分析法 AHP</h1><h2 id="针对问题类型"><a href="#针对问题类型" class="headerlink" title="针对问题类型"></a>针对问题类型</h2><p>适用于解决评价类问题<br>可以使用打分法解决评价类问题<br><img src="/2021/03/30/AHP/pic1.png" class="" title="打分表"></p>
<h2 id="如何解决评价类问题"><a href="#如何解决评价类问题" class="headerlink" title="如何解决评价类问题"></a>如何解决评价类问题</h2><p>明确三个问题</p>
<ol>
<li>我们评价的目标</li>
<li>为了达到这个目标有几种方案</li>
<li>评价的准则、指标</li>
</ol>
<hr>
<h2 id="搜索文献地址"><a href="#搜索文献地址" class="headerlink" title="搜索文献地址"></a>搜索文献地址</h2><p><a target="_blank" rel="noopener" href="https://www.cnki.net/">知网</a><br><a target="_blank" rel="noopener" href="https://scholar.google.com/">Google学术</a><br><a target="_blank" rel="noopener" href="https://xueshu.baidu.com/">百度学术</a></p>
<h2 id="如何确定指标权重及各项的分数"><a href="#如何确定指标权重及各项的分数" class="headerlink" title="如何确定指标权重及各项的分数"></a>如何确定指标权重及各项的分数</h2><p>分而治之:<br>一次性考虑这五个指标之间的关系,往往考虑不周<br>解决方法:<br>两个两个指标进行比较,最终根据两两比较的结果来推算出权重。<br><img src="/2021/03/30/AHP/pic2.png" class="" title="层次分析法重要性表格"></p>
<h2 id="如何处理填写的数据"><a href="#如何处理填写的数据" class="headerlink" title="如何处理填写的数据"></a>如何处理填写的数据</h2><p>表可以转化成一个5x5的方阵 记该方阵为A 对应元素为$a_{ij}$</p>
<ol>
<li><script type="math/tex; mode=display">a_{ij}表示的意义是,与指标j相比,i的重要程度</script></li>
<li><script type="math/tex; mode=display">当i=j时,两个指标相同,因此同等重要记为1,这就解释了主对角线元素为1</script></li>
<li><script type="math/tex; mode=display">a_{ij}>0且满足a_{ij} \times a_{ji}=1 (我们称满足这一条件的矩阵为正互反矩阵)</script>该矩阵就是层次分析法的判断矩阵</li>
</ol>
<h2 id="一致矩阵"><a href="#一致矩阵" class="headerlink" title="一致矩阵"></a>一致矩阵</h2><p><strong> 判断矩阵可能存在Bug </strong></p>
<h2 id=""><a href="#" class="headerlink" title=""></a><img src="/2021/03/30/AHP/pic4.png" class="" title="判断矩阵不一致的情况"></h2><p>若正互反矩阵满足</p>
<script type="math/tex; mode=display">a_{ij} \times a{jk} = a_{ik}</script><p>则该矩阵为一致矩阵</p>
<h2 id="注意-在使用判断矩阵求权重之前-必须对其进行一致性检验"><a href="#注意-在使用判断矩阵求权重之前-必须对其进行一致性检验" class="headerlink" title="注意:在使用判断矩阵求权重之前,必须对其进行一致性检验"></a><font color="#ff0000">注意:在使用判断矩阵求权重之前,必须对其进行一致性检验</font></h2><script type="math/tex; mode=display">
\begin{bmatrix}
a_{11} &a_{12} &\cdots &a_{1n} \\
a_{21} &a_{22} &\cdots &a_{2n} \\
\vdots &\vdots &\ddots &\vdots \\
a_{n1} &a_{n2} &\cdots &a_{nn} \\
\end{bmatrix}</script><p>为一致矩阵的充要条件是</p>
<script type="math/tex; mode=display">
\left\{
    \begin{array}
        \leftline 
        a_{ij} > 0\\
        a_{11}=a_{22}=\cdots=a_{nn}\\ 
        \begin{bmatrix}
            a_{i1},&a_{i2},&\cdots,&a_{in}
        \end{bmatrix}=k
        \begin{bmatrix}
            a_{11},&a_{12},&\cdots,&a_{1n}
        \end{bmatrix}
    \end{array}
\right .</script><hr>
<p>引理:A为n阶方阵,且r(A)=1,则A有一个特征值为tr(A),其余特征值均为0<br>因为一致矩阵的各行成比例,所以一致矩阵的秩一定为1<br>由引理可知:一致矩阵有一个特征值为m,其余特征值均为0<br>容易得到,特征值为n时,对应的特征向量刚好为</p>
<script type="math/tex; mode=display">
k
\begin{bmatrix}
    \cfrac{1}{a_{11}},&\cfrac{1}{a_{12}},&\cdots,&\cfrac{1}{a_{1n}}
\end{bmatrix}</script><hr>
<p>引理:m阶正互反矩阵A为一致矩阵时当且仅当最大特征值入m=n<br>且当正互反矩阵A非一致时,一定满足入m&gt;n</p>
<h2 id="一致性检验"><a href="#一致性检验" class="headerlink" title="一致性检验"></a>一致性检验</h2><ol>
<li>计算一致性指标CI<script type="math/tex; mode=display">
CI=\cfrac{\lambda_{max}-n}{n-1}</script></li>
<li>查找对应的平均一致性指标RI<img src="/2021/03/30/AHP/pic5.png" class="" title="平均一致性指标"></li>
<li>计算一致性比例CR<script type="math/tex; mode=display">
CR=\frac{CI}{CR}</script></li>
</ol>
<p><strong> 如果CR&lt;0.1,则可认为判断矩阵的一致性可以接受;否则需要对判断矩阵进行修正 </strong></p>
<h2 id="计算权重"><a href="#计算权重" class="headerlink" title="计算权重"></a>计算权重</h2><h3 id="一致矩阵-1"><a href="#一致矩阵-1" class="headerlink" title="一致矩阵"></a>一致矩阵</h3><p>取出其中一列数据计算即可,则每一位的权重</p>
<script type="math/tex; mode=display">
w_i=\frac{a_{i1}}{\sum\limits_{j=1}^na_{j1}}</script><h3 id="非一致判断矩阵矩阵"><a href="#非一致判断矩阵矩阵" class="headerlink" title="非一致判断矩阵矩阵"></a>非一致判断矩阵矩阵</h3><h4 id="1-算术平均法求权重"><a href="#1-算术平均法求权重" class="headerlink" title="1. 算术平均法求权重"></a>1. 算术平均法求权重</h4><ol>
<li>将判断矩阵按列归一化，即每个元素除以其所在列的和</li>
<li>将归一化的各列相加（按行求和）</li>
<li>将相加后向量中每个元素除以n即可得到权重向量<script type="math/tex; mode=display">
w_i=\cfrac{1}{n}\sum\limits_{j=1}^{n}{\cfrac{a_{ij}}{\sum\limits_{k=1}^{n}a_{kj}}},
(i=1,2,\cdots,n)</script><h4 id="2-几何平均法"><a href="#2-几何平均法" class="headerlink" title="2. 几何平均法"></a>2. 几何平均法</h4></li>
<li>将判断矩阵的元素按照行相乘得到一个新的列向量</li>
<li>将新的向量的每个分量开n次方</li>
<li>对该列向量进行归一化即可得到权重向量<script type="math/tex; mode=display">
w_i=\cfrac{(\prod\limits_{j=1}^{n}a_{ij})^{\frac{1}{n}}}{\sum\limits_{k=1}^{n}{(\prod\limits_{j=1}^{n}a_{kj})^{\frac{1}{n}}}}</script><h4 id="3-特征值法"><a href="#3-特征值法" class="headerlink" title="3.特征值法"></a>3.特征值法</h4></li>
<li>求出矩阵A的最大特征值以及其对应的特征向量</li>
<li>对求出的特征向量进行归一化即可得到我们的权重</li>
</ol>
<h2 id="如何修正判断矩阵"><a href="#如何修正判断矩阵" class="headerlink" title="如何修正判断矩阵"></a>如何修正判断矩阵</h2><p>如果$CR&gt;0.1$,需要判断矩阵进行修正<br>向一致矩阵调整 使各列尽量成比例</p>
<h2 id="计算各层元素对目标的权重"><a href="#计算各层元素对目标的权重" class="headerlink" title="计算各层元素对目标的权重"></a>计算各层元素对目标的权重</h2><p>计算各层元素对目标的权重,并进行排序</p>
<h2 id="局限性"><a href="#局限性" class="headerlink" title="局限性"></a>局限性</h2><ol>
<li>评价的决策层不能太多,太多的话n会很大,判断矩阵和一致矩阵差异</li>
<li>如果决策层中指标的数据是已知的,那么我们如何利用这些数据来使评价的更加准确呢?</li>
</ol>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://alexzhu2001.github.io/AlexZhu2001/2021/01/30/Unix-Linux-who/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/head.png">
      <meta itemprop="name" content="Alex Zhu">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Alex's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/01/30/Unix-Linux-who/" class="post-title-link" itemprop="url">Unix-Linux编程实践1-who命令的实现</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-01-30 15:01:58" itemprop="dateCreated datePublished" datetime="2021-01-30T15:01:58+08:00">2021-01-30</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-07-18 21:17:06" itemprop="dateModified" datetime="2021-07-18T21:17:06+08:00">2021-07-18</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Unix-Linux编程实践1-who命令的实现"><a href="#Unix-Linux编程实践1-who命令的实现" class="headerlink" title="Unix-Linux编程实践1-who命令的实现"></a>Unix-Linux编程实践1-who命令的实现</h1><h2 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h2><p>在使用Unix/Linux系统时，常常需要知道有哪些用户正在使用系统，系统是否繁忙，为了回答这些问题，所有的多用户系统都会有这个命令 </p>
<h2 id="关于who"><a href="#关于who" class="headerlink" title="关于who"></a>关于who</h2><p>我们将通过三个问题的解答来学习who命令</p>
<h3 id="who能做什么"><a href="#who能做什么" class="headerlink" title="who能做什么"></a>who能做什么</h3><p>Unix/Linux who命令用于显示系统中有哪些使用者正在上面，显示的资料包含了使用者 ID、使用的终端机、从哪边连上来的、上线时间、呆滞时间、CPU 使用量、动作等等。</p>
<p>使用权限：所有使用者都可使用。<br><img src="/2021/01/30/Unix-Linux-who/1.png" class="" title="OpenBSD运行结果"></p>
<h3 id="who是如何工作的"><a href="#who是如何工作的" class="headerlink" title="who是如何工作的"></a>who是如何工作的</h3><p>通过命令<code>man who</code>可以打开who的帮助文档</p>
<img src="/2021/01/30/Unix-Linux-who/2.png" class="" title="who的帮助文档">
<p>从上文易知 已登陆用户信息存储在/var/run/utmp中，who通过读取该文件来获得信息<br>通过<code>man utmp</code>可以获得utmp文件记录的数据结构信息</p>
<img src="/2021/01/30/Unix-Linux-who/3.png" class="" title="utmp文档">
<p>所以<code>who</code>的工作原理可用以下流程完成</p>
<div id="flowchart-0" class="flow-chart"></div>

<h3 id="如何编写who"><a href="#如何编写who" class="headerlink" title="如何编写who"></a>如何编写who</h3><h5 id="如何读取文件"><a href="#如何读取文件" class="headerlink" title="如何读取文件"></a>如何读取文件</h5><p>通过搜索和read和file有关的文档<br><img src="/2021/01/30/Unix-Linux-who/4.png" class="" title="man read file"><br>可以找到open(2)<br><img src="/2021/01/30/Unix-Linux-who/5.png" class="" title="man 2 open"><br>通过open的文档可以找到其他的函数，分别是read close<br>open在打开文件时需要提供打开方式</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>open</th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>target</td>
<td>打开文件</td>
</tr>
<tr>
<td>header</td>
<td><code>#include &lt;fcntl.h&gt;</code></td>
</tr>
<tr>
<td>definition</td>
<td><code>int fd = open(const char *name,int flags)</code></td>
</tr>
<tr>
<td>arguments</td>
<td>name:文件名,flags:读取模式</td>
</tr>
<tr>
<td>ret</td>
<td>-1 error,int success</td>
</tr>
</tbody>
</table>
</div>
<p>其中 flags可以为O_RDONLY O_WRONLY O_RDWR</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>read</th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>target</td>
<td>读取文件</td>
</tr>
<tr>
<td>header</td>
<td><code>#include &lt;unistd.h&gt;</code></td>
</tr>
<tr>
<td>definition</td>
<td><code>ssize_t numread = read(int fd,void *buf,size_t qty)</code></td>
</tr>
<tr>
<td>arguments</td>
<td>fd:文件描述符,buf:缓冲区,qty:读取数量</td>
</tr>
<tr>
<td>ret</td>
<td>-1 error,numread success</td>
</tr>
</tbody>
</table>
</div>
<div class="table-container">
<table>
<thead>
<tr>
<th>close</th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>target</td>
<td>关闭文件</td>
</tr>
<tr>
<td>header</td>
<td><code>#include &lt;unistd.h&gt;</code></td>
</tr>
<tr>
<td>definition</td>
<td><code>int result = close(int fd)</code></td>
</tr>
<tr>
<td>arguments</td>
<td>fd:文件描述符</td>
</tr>
<tr>
<td>ret</td>
<td>-1 error,0 success</td>
</tr>
</tbody>
</table>
</div>
<h3 id="编写who1-c"><a href="#编写who1-c" class="headerlink" title="编写who1.c"></a>编写who1.c</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* </span></span><br><span class="line"><span class="comment"> * who version1 </span></span><br><span class="line"><span class="comment"> * show who login this machine</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;utmp.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;fcntl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SHOW_HOSTS</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">show_info</span><span class="params">(struct utmp *utmpbuf)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc,<span class="keyword">char</span> *argv[])</span></span>&#123;</span><br><span class="line">	<span class="class"><span class="keyword">struct</span> <span class="title">utmp</span> <span class="title">rec</span>;</span></span><br><span class="line">	<span class="keyword">int</span> utmpfd;</span><br><span class="line">	<span class="keyword">int</span> reclen=<span class="keyword">sizeof</span>(rec);</span><br><span class="line">    utmpfd=open(_PATH_UTMP,O_RDONLY);</span><br><span class="line">	<span class="keyword">if</span>(utmpfd==<span class="number">-1</span>)&#123;</span><br><span class="line">		perror(_PATH_UTMP);</span><br><span class="line">		<span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">while</span>(read(utmpfd,&amp;rec,reclen) == reclen)&#123;</span><br><span class="line">		show_info(&amp;rec);</span><br><span class="line">	&#125;</span><br><span class="line">	close(utmpfd);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">show_info</span><span class="params">(struct utmp *utmpbuf)</span></span>&#123;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%-8.8s&quot;</span>,utmpbuf-&gt;ut_name);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot; &quot;</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%-8.8s&quot;</span>,utmpbuf-&gt;ut_line);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot; &quot;</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%10ld&quot;</span>,(<span class="keyword">long</span>)utmpbuf-&gt;ut_time);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot; &quot;</span>);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> SHOW_HOSTS</span></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;(%s)&quot;</span>,utmpbuf-&gt;ut_host);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>编译who1<br><code>cc who1.c -o who1</code><br>执行<br><code>./who1</code><br><img src="/2021/01/30/Unix-Linux-who/6.png" class="" title="who1"><br>可见 <code>who1</code>已经可以工作了，但是仍有很多可以完善</p>
<ul>
<li>消除空白记录</li>
<li>正确显示时间</li>
</ul>
<h3 id="编写who2-c"><a href="#编写who2-c" class="headerlink" title="编写who2.c"></a>编写who2.c</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* </span></span><br><span class="line"><span class="comment"> * who version2 </span></span><br><span class="line"><span class="comment"> * show who login this machine</span></span><br><span class="line"><span class="comment"> * change time format</span></span><br><span class="line"><span class="comment"> * delete useless one</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *          open utmp file</span></span><br><span class="line"><span class="comment"> *     +---&gt;read record-----&lt;is eof&gt;-----+</span></span><br><span class="line"><span class="comment"> *     |    print record--&lt;is empty&gt;--+  |                                </span></span><br><span class="line"><span class="comment"> *     |                              |  |</span></span><br><span class="line"><span class="comment"> *     +------------------------------+  |  </span></span><br><span class="line"><span class="comment"> *                                       |</span></span><br><span class="line"><span class="comment"> *          close utmp file&lt;-------------+</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;utmp.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;fcntl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;time.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SHOW_HOSTS</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">show_info</span><span class="params">(struct utmp *utmpbuf)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">show_time</span><span class="params">(<span class="keyword">time_t</span> time)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc,<span class="keyword">char</span> *argv[])</span></span>&#123;</span><br><span class="line">	<span class="class"><span class="keyword">struct</span> <span class="title">utmp</span> <span class="title">rec</span>;</span></span><br><span class="line">	<span class="keyword">int</span> utmpfd;</span><br><span class="line">	<span class="keyword">int</span> reclen=<span class="keyword">sizeof</span>(rec);</span><br><span class="line">    utmpfd=open(_PATH_UTMP,O_RDONLY);</span><br><span class="line">	<span class="keyword">if</span>(utmpfd==<span class="number">-1</span>)&#123;</span><br><span class="line">		perror(_PATH_UTMP);</span><br><span class="line">		<span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">while</span>(read(utmpfd,&amp;rec,reclen) == reclen)&#123;</span><br><span class="line">		show_info(&amp;rec);</span><br><span class="line">	&#125;</span><br><span class="line">	close(utmpfd);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">show_info</span><span class="params">(struct utmp *utmpbuf)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">strlen</span>(utmpbuf-&gt;ut_name)==<span class="number">0</span>) <span class="keyword">return</span>;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%-8.8s&quot;</span>,utmpbuf-&gt;ut_name);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot; &quot;</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%-8.8s&quot;</span>,utmpbuf-&gt;ut_line);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot; &quot;</span>);</span><br><span class="line">	<span class="comment">//printf(&quot;%10ld&quot;,(long)utmpbuf-&gt;ut_time);</span></span><br><span class="line">	show_time(utmpbuf-&gt;ut_time);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot; &quot;</span>);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> SHOW_HOSTS</span></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;(%s)&quot;</span>,utmpbuf-&gt;ut_host);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">show_time</span><span class="params">(<span class="keyword">time_t</span> time)</span></span>&#123;</span><br><span class="line">    <span class="keyword">char</span> *str=ctime(&amp;time);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%12.12s&quot;</span>,str+<span class="number">4</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>编译并运行<br><code>cc who2.c -o who2&amp;&amp;./who2</code></p>
<img src="/2021/01/30/Unix-Linux-who/7.png" class="" title="who2">
<p>此时<code>who</code>已经可以按要求正常运行了</p>
<a href="/2021/01/30/Unix-Linux-who/who1.c" title="who1.c">who1.c</a>
<a href="/2021/01/30/Unix-Linux-who/who2.c" title="who2.c">who2.c</a><script src="https://cdnjs.cloudflare.com/ajax/libs/raphael/2.2.7/raphael.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/flowchart/1.6.5/flowchart.min.js"></script><textarea id="flowchart-0-code" style="display: none">open_utmp=>operation: 打开utmp
read_rec=>operation: 读取记录
show=>operation: 显示记录
close_utmp=>operation: 关闭记录
isFinished=>condition: 读取完了?
open_utmp(right)->read_rec(right)->show->isFinished
isFinished(yes)->close_utmp
isFinished(no)->read_rec</textarea><textarea id="flowchart-0-options" style="display: none">{"scale":1,"line-width":2,"line-length":50,"text-margin":10,"font-size":12}</textarea><script>  var code = document.getElementById("flowchart-0-code").value;  var options = JSON.parse(decodeURIComponent(document.getElementById("flowchart-0-options").value));  var diagram = flowchart.parse(code);  diagram.drawSVG("flowchart-0", options);</script>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://alexzhu2001.github.io/AlexZhu2001/2021/01/30/BinarySearch-2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/head.png">
      <meta itemprop="name" content="Alex Zhu">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Alex's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/01/30/BinarySearch-2/" class="post-title-link" itemprop="url">BinarySearch-2</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-01-30 14:37:46" itemprop="dateCreated datePublished" datetime="2021-01-30T14:37:46+08:00">2021-01-30</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-07-18 21:17:06" itemprop="dateModified" datetime="2021-07-18T21:17:06+08:00">2021-07-18</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="二分查找-2"><a href="#二分查找-2" class="headerlink" title="二分查找-2"></a>二分查找-2</h1><h2 id="思路二-在循环体中排除"><a href="#思路二-在循环体中排除" class="headerlink" title="思路二 在循环体中排除"></a>思路二 在循环体中排除</h2><h4 id="代码模板"><a href="#代码模板" class="headerlink" title="代码模板"></a>代码模板</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">bs</span><span class="params">(vector&lt;T&gt; nums,T target)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> l=<span class="number">0</span>,r=nums.<span class="built_in">size</span>()<span class="number">-1</span>,mid;</span><br><span class="line">    <span class="keyword">while</span>(l&lt;r)&#123;</span><br><span class="line">        mid=l+(r-l)/<span class="number">2</span>;</span><br><span class="line">        <span class="keyword">if</span>(nums[mid]&lt;target)</span><br><span class="line">            l=mid+<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">else</span> r=mid;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> l;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="细节分析"><a href="#细节分析" class="headerlink" title="细节分析"></a>细节分析</h2><ul>
<li>循环退出条件<code>l&lt;r</code></li>
<li>边界写法 <ul>
<li><code>r = mid</code> 和 <code>l = mid + 1</code> 和 <code>int mid = l + (r - l) / 2;</code> 一定是配对出现的；</li>
<li><code>r = mid - 1</code> 和 <code>l = mid</code> 和 <code>int mid = l + (r - l + 1) / 2;</code> 一定是配对出现的。</li>
</ul>
</li>
</ul>
<h2 id="适用范围"><a href="#适用范围" class="headerlink" title="适用范围"></a>适用范围</h2><p>这种二分查找的思路，对于查找边界问题，会使得思考的过程变得简单。</p>
<h2 id="练习"><a href="#练习" class="headerlink" title="练习"></a>练习</h2><ol>
<li><h3 id="搜索插入位置"><a href="#搜索插入位置" class="headerlink" title="搜索插入位置"></a>搜索插入位置</h3><a target="_blank" rel="noopener" href="https://leetcode-cn.com/problems/search-insert-position/description/">题目描述</a><h4 id="解题思路"><a href="#解题思路" class="headerlink" title="解题思路"></a>解题思路</h4>首先 题目未说明数组是否为空 先判断是否为空<br>如果最后一个元素小于目标值 则应返回最后一个元素的下标加一 也即数组长度<br>其他情况可利用如上方法二分查找即可<h4 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">searchInsert</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; nums, <span class="keyword">int</span> target)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(nums.<span class="built_in">size</span>()==<span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span>(nums[nums.<span class="built_in">size</span>()<span class="number">-1</span>]&lt;target) <span class="keyword">return</span> nums.<span class="built_in">size</span>();</span><br><span class="line">        <span class="keyword">int</span> l=<span class="number">0</span>,r=nums.<span class="built_in">size</span>()<span class="number">-1</span>,mid;</span><br><span class="line">        <span class="keyword">while</span>(l&lt;r)&#123;</span><br><span class="line">            mid=l+(r-l)/<span class="number">2</span>;</span><br><span class="line">            <span class="keyword">if</span>(nums[mid]&lt;target)&#123;</span><br><span class="line">                l=mid+<span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                r=mid;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> l;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<a href="/2021/01/30/BinarySearch-2/35.%E6%90%9C%E7%B4%A2%E6%8F%92%E5%85%A5%E4%BD%8D%E7%BD%AE.cpp" title="35.搜索插入位置">35.搜索插入位置</a>
</li>
</ol>
<hr>
<p>2. </p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://alexzhu2001.github.io/AlexZhu2001/2021/01/30/validTicTacToe/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/head.png">
      <meta itemprop="name" content="Alex Zhu">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Alex's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/01/30/validTicTacToe/" class="post-title-link" itemprop="url">validTicTacToe</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-01-30 14:00:59" itemprop="dateCreated datePublished" datetime="2021-01-30T14:00:59+08:00">2021-01-30</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-07-18 21:17:06" itemprop="dateModified" datetime="2021-07-18T21:17:06+08:00">2021-07-18</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="LeetCode-794-有效的井字游戏"><a href="#LeetCode-794-有效的井字游戏" class="headerlink" title="LeetCode 794 有效的井字游戏"></a>LeetCode 794 有效的井字游戏</h1><h2 id="题目描述"><a href="#题目描述" class="headerlink" title="题目描述"></a>题目描述</h2><p>用字符串数组作为井字游戏的游戏板 board。当且仅当在井字游戏过程中，玩家有可能将字符放置成游戏板所显示的状态时，才返回 true。</p>
<p>游戏该板是一个 3 x 3 数组，由字符 “ “，”X” 和 “O” 组成。字符 “ “ 代表一个空位。</p>
<p>以下是井字游戏的规则：</p>
<ul>
<li>玩家轮流将字符放入空位（” “）中。</li>
<li>第一个玩家总是放字符 “X”，且第二个玩家总是放字符 “O”。</li>
<li>“X” 和 “O” 只允许放置在空位中，不允许对已放有字符的位置进行填充。</li>
<li>当有 3 个相同（且非空）的字符填充任何行、列或对角线时，游戏结束。</li>
<li>当所有位置非空时，也算为游戏结束。</li>
<li>如果游戏结束，玩家不允许再放置字符。</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">示例 <span class="number">1</span>:</span><br><span class="line">输入: board = [<span class="string">&quot;O  &quot;</span>, <span class="string">&quot;   &quot;</span>, <span class="string">&quot;   &quot;</span>]</span><br><span class="line">输出: false</span><br><span class="line">解释: 第一个玩家总是放置“X”。</span><br><span class="line"></span><br><span class="line">示例 <span class="number">2</span>:</span><br><span class="line">输入: board = [<span class="string">&quot;XOX&quot;</span>, <span class="string">&quot; X &quot;</span>, <span class="string">&quot;   &quot;</span>]</span><br><span class="line">输出: false</span><br><span class="line">解释: 玩家应该是轮流放置的。</span><br><span class="line"></span><br><span class="line">示例 <span class="number">3</span>:</span><br><span class="line">输入: board = [<span class="string">&quot;XXX&quot;</span>, <span class="string">&quot;   &quot;</span>, <span class="string">&quot;OOO&quot;</span>]</span><br><span class="line">输出: false</span><br><span class="line"></span><br><span class="line">示例 <span class="number">4</span>:</span><br><span class="line">输入: board = [<span class="string">&quot;XOX&quot;</span>, <span class="string">&quot;O O&quot;</span>, <span class="string">&quot;XOX&quot;</span>]</span><br><span class="line">输出: true</span><br></pre></td></tr></table></figure>
<p>说明:</p>
<ul>
<li>游戏板 <code>board</code> 是长度为 3 的字符串数组，其中每个字符串 <code>board[i]</code> 的长度为 3。</li>
<li><code>board[i][j]</code> 是集合 <code>&#123;&quot; &quot;, &quot;X&quot;, &quot;O&quot;&#125;</code> 中的一个字符。</li>
</ul>
<h2 id="解题思路"><a href="#解题思路" class="headerlink" title="解题思路"></a>解题思路</h2><p>首先 由于放置<code>X</code>先于<code>O</code> 则<code>X</code>的数量大于等于<code>O</code>的数量，且之多比<code>O</code>多一个</p>
<p>如满足以上条件，分析可能的局面如下四种</p>
<ul>
<li>游戏结束后没有赢家</li>
<li>执<code>X</code>者获胜 此时<code>X</code>数量比<code>O</code>多一个</li>
<li>执<code>X</code>者获胜 此时<code>X</code>数量与<code>O</code>相等</li>
<li>两个人都赢 此情况违背了规则</li>
</ul>
<p>所以可使用一个函数判断属于哪种局面，并得到结果</p>
<h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">validTicTacToe</span><span class="params">(vector&lt;string&gt;&amp; board)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> x=<span class="number">0</span>,o=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> i:board)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">auto</span> j:i)&#123;</span><br><span class="line">                <span class="keyword">if</span>(j==<span class="string">&#x27;X&#x27;</span>) x++;</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span>(j==<span class="string">&#x27;O&#x27;</span>) o++;       </span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(x-o&gt;<span class="number">1</span>||x-o&lt;<span class="number">0</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">int</span> res=<span class="built_in">winer</span>(board);</span><br><span class="line">        <span class="built_in"><span class="keyword">switch</span></span> (res)</span><br><span class="line">        &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">return</span> (x-o)==<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">            <span class="keyword">return</span> x==o;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">winer</span><span class="params">(vector&lt;string&gt;&amp; board)</span></span>&#123;</span><br><span class="line">        <span class="keyword">bool</span> xW=<span class="literal">false</span>,oW=<span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> i : board)&#123;</span><br><span class="line">            <span class="keyword">if</span>(i==<span class="string">&quot;XXX&quot;</span>||i==<span class="string">&quot;OOO&quot;</span>)&#123;</span><br><span class="line">                i[<span class="number">0</span>]==<span class="string">&#x27;X&#x27;</span>?xW=<span class="literal">true</span>:oW=<span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">3</span>;i++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(board[<span class="number">0</span>][i]==board[<span class="number">1</span>][i]&amp;&amp;board[<span class="number">1</span>][i]==board[<span class="number">2</span>][i]&amp;&amp;board[<span class="number">0</span>][i]!=<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">                board[<span class="number">0</span>][i]==<span class="string">&#x27;X&#x27;</span>?xW=<span class="literal">true</span>:oW=<span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(board[<span class="number">0</span>][<span class="number">0</span>]==board[<span class="number">1</span>][<span class="number">1</span>]&amp;&amp;board[<span class="number">0</span>][<span class="number">0</span>]==board[<span class="number">2</span>][<span class="number">2</span>]&amp;&amp;board[<span class="number">0</span>][<span class="number">0</span>]!=<span class="string">&#x27; &#x27;</span>)&#123;</span><br><span class="line">            board[<span class="number">0</span>][<span class="number">0</span>]==<span class="string">&#x27;X&#x27;</span>?xW=<span class="literal">true</span>:oW=<span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(board[<span class="number">0</span>][<span class="number">2</span>]==board[<span class="number">1</span>][<span class="number">1</span>]&amp;&amp;board[<span class="number">1</span>][<span class="number">1</span>]==board[<span class="number">2</span>][<span class="number">0</span>]&amp;&amp;board[<span class="number">1</span>][<span class="number">1</span>]!=<span class="string">&#x27; &#x27;</span>)&#123;</span><br><span class="line">            board[<span class="number">1</span>][<span class="number">1</span>]==<span class="string">&#x27;X&#x27;</span>?xW=<span class="literal">true</span>:oW=<span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(oW&amp;&amp;xW) <span class="keyword">return</span> <span class="number">3</span>;</span><br><span class="line">        <span class="keyword">if</span>(!(oW||xW)) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span> xW?<span class="number">1</span>:<span class="number">2</span>; </span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<a href="/2021/01/30/validTicTacToe/794.%E6%9C%89%E6%95%88%E7%9A%84%E4%BA%95%E5%AD%97%E6%B8%B8%E6%88%8F.cpp" title="794.有效的井字游戏.cpp">794.有效的井字游戏.cpp</a>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Alex Zhu"
      src="/images/head.png">
  <p class="site-author-name" itemprop="name">Alex Zhu</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">17</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">16</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/AlexZhu2001" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;AlexZhu2001" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
  </div>



      </div>
      
        <script type="text/javascript" charset="utf-8" src="/js/tagcloud.js"></script>
        <script type="text/javascript" charset="utf-8" src="/js/tagcanvas.js"></script>
        <div class="widget-wrap">
            <h3 class="widget-title">Tag Cloud</h3>
            <div id="myCanvasContainer" class="widget tagcloud">
                <canvas width="250" height="250" id="resCanvas" style="width=100%">
                    <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/BinarySearch/" rel="tag">BinarySearch</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/BuildForWindows/" rel="tag">BuildForWindows</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CMake/" rel="tag">CMake</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linux/" rel="tag">Linux</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Math/" rel="tag">Math</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Network/" rel="tag">Network</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SDL2/" rel="tag">SDL2</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SDN/" rel="tag">SDN</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/TestPost/" rel="tag">TestPost</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Unix/" rel="tag">Unix</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/VS2019/" rel="tag">VS2019</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/" rel="tag">动态规划</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%AD%97%E7%AC%A6%E4%B8%B2/" rel="tag">字符串</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%95%B0%E7%BB%84/" rel="tag">数组</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%A0%88/" rel="tag">栈</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%AE%97%E6%B3%95/" rel="tag">算法</a><span class="tag-list-count">10</span></li></ul>
                </canvas>
            </div>
        </div>
      
    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        
  <div class="beian"><a href="https://beian.miit.gov.cn/" rel="noopener" target="_blank">皖ICP备2021001500号-1 </a>
      <img src="/images/gonganbeian.png" style="display: inline-block;"><a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=34100202000384" rel="noopener" target="_blank">皖公网安备 34100202000384号 </a>
  </div>

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Alex Zhu</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://mist.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Mist</a> 强力驱动
  </div><script color="0,0,255" opacity="0.5" zIndex="-1" count="99" src="https://cdn.jsdelivr.net/npm/canvas-nest.js@1/dist/canvas-nest.js"></script>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>
  <script src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  

  
    <script src="https://cdn.jsdelivr.net/gh/Sanarous/files@1.151/js/clicksocialvalue.js"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome/css/font-awesome.min.css"/>
    <script src="/live2d-widget/assets/jquery-ui.min.js"></script>
    <script src="/live2d-widget/assets/autoload.js"></script>
</body>
</html>
